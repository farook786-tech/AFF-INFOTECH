<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PortfolioForge - AI Portfolio Builder with Assessment System</title>
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="PortfolioForge - AI Portfolio Builder with Assessment System" />
    <meta property="og:description" content="Create your perfect portfolio with AI and assess your skills" />
    <meta property="og:image" content="https://via.placeholder.com/1200x630/4F46E5/FFFFFF?text=PortfolioForge" />
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="PortfolioForge - AI Portfolio Builder with Assessment System" />
    <meta name="twitter:description" content="Create your perfect portfolio with AI and assess your skills" />
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630/4F46E5/FFFFFF?text=PortfolioForge" />
    
    <!-- Other meta tags -->
    <meta name="description" content="PortfolioForge - AI Portfolio Builder with Intelligent Assessment System">
    <link rel="canonical" href="">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;500&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* All your existing CSS styles remain the same */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--darker);
            color: var(--light);
            overflow-x: hidden;
        }
        
        .font-mono { font-family: 'Roboto Mono', monospace; }
        .hidden { display: none !important; }
        
        /* Animated Background */
        .animated-bg {
            background: linear-gradient(-45deg, #0f172a, #1e293b, #334155, #0f172a);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* All other CSS styles remain unchanged */
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }
        
        .btn-primary:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: transform 0.5s ease;
            z-index: -1;
        }
        
        .btn-primary:hover:before {
            transform: translateX(0);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #db2777);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(236, 72, 153, 0.3);
        }
        
        /* Dropzone */
        .drop-zone {
            border: 2px dashed #475569;
            transition: all 0.3s ease;
        }
        
        .drop-zone:hover, .drop-zone.dragover {
            border-color: var(--primary);
            background-color: rgba(99, 102, 241, 0.1);
        }
        
        .drop-zone.has-file {
            border-color: #22c55e;
            background-color: rgba(34, 197, 94, 0.1);
        }
        
        /* Page transitions */
        .view { animation: fadeIn 0.5s ease-in-out; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Editor Styles */
        .editor-input {
            background-color: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(71, 85, 105, 0.5);
            color: var(--light);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            width: 100%;
            transition: all 0.2s;
        }
        
        .editor-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        
        .editor-section {
            background: rgba(30, 41, 59, 0.5);
            backdrop-filter: blur(5px);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }
        
        /* Theme Selector */
        .theme-option {
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .theme-option:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
        }
        
        .theme-option.selected {
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.4);
        }
        
        /* Floating particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 50%;
            pointer-events: none;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
        
        /* Social link buttons */
        .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .social-link:hover {
            transform: translateY(-3px);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
        }
        
        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Network status indicator */
        .network-status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(30, 41, 59, 0.9);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #22c55e;
            display: inline-block;
        }
        
        .status-indicator.error {
            background-color: #ef4444;
        }
        
        /* Assessment System Styles */
        .assessment-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .assessment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease;
        }
        
        .feedback-correct {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .feedback-incorrect {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .tab-active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }
        
        .skill-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .skill-progress {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease;
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
            100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
        }
        
        /* Chart container styling */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        /* Student Dashboard Styles */
        .student-card {
            transition: all 0.3s ease;
        }
        
        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-gold {
            background-color: #fbbf24;
            color: #78350f;
        }
        
        .badge-silver {
            background-color: #d1d5db;
            color: #1f2937;
        }
        
        .badge-bronze {
            background-color: #f97316;
            color: #7c2d12;
        }
        
        /* User Profile Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-body {
            margin-bottom: 1.5rem;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }
        
        /* Achievement Badge */
        .achievement-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            font-weight: bold;
            margin-right: 0.5rem;
        }
        
        .achievement-badge.silver {
            background: linear-gradient(135deg, #d1d5db, #9ca3af);
        }
        
        .achievement-badge.bronze {
            background: linear-gradient(135deg, #f97316, #ea580c);
        }
        
        /* Assessment Review Styles */
        .assessment-review-item {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }
        
        .review-question {
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .review-options {
            margin-bottom: 1rem;
        }
        
        .review-option {
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .review-option.correct {
            background-color: rgba(16, 185, 129, 0.2);
            border-left: 4px solid #10b981;
        }
        
        .review-option.incorrect {
            background-color: rgba(239, 68, 68, 0.2);
            border-left: 4px solid #ef4444;
        }
        
        .review-option.selected {
            background-color: rgba(99, 102, 241, 0.2);
            border-left: 4px solid #6366f1;
        }
        
        .review-explanation {
            background-color: rgba(30, 41, 59, 0.7);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }
        
        .review-explanation-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #94a3b8;
        }
        
        /* Peer Review Styles */
        .peer-review-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .peer-review-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .portfolio-preview {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
            max-height: 400px;
            overflow-y: auto;
        }
        
        .rating-stars {
            display: flex;
            gap: 0.25rem;
        }
        
        .rating-stars i {
            color: #fbbf24;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .rating-stars i:hover {
            transform: scale(1.2);
        }
        
        .comment-box {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(71, 85, 105, 0.5);
            color: var(--light);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            width: 100%;
            min-height: 100px;
            transition: all 0.2s;
            resize: vertical;
        }
        
        .comment-box:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        
        .review-category {
            margin-bottom: 1.5rem;
        }
        
        .review-category h4 {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #94a3b8;
        }
        
        .review-feedback {
            background: rgba(30, 41, 59, 0.7);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }
        
        /* Portfolio card styles for peer review */
        .portfolio-card {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .portfolio-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .portfolio-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .portfolio-card-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }
        
        .portfolio-card-meta {
            color: #94a3b8;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }
        
        .portfolio-card-description {
            color: #cbd5e1;
            margin-bottom: 1rem;
        }
        
        .portfolio-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .portfolio-card-stats {
            display: flex;
            gap: 1rem;
        }
        
        .portfolio-card-stat {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            color: #94a3b8;
            font-size: 0.875rem;
        }
        
        .portfolio-card-badge {
            background: rgba(99, 102, 241, 0.2);
            color: #a5b4fc;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        /* QR Code Section Styles */
        .qr-section {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 0.75rem;
            padding: 1.5rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
            text-align: center;
        }
        
        .qr-container {
            display: flex;
            justify-content: center;
            margin: 1.5rem 0;
        }
        
        .qr-info {
            margin-top: 1rem;
            color: #94a3b8;
            font-size: 0.875rem;
        }
        
        /* New Portfolio Theme Styles */
        .new-portfolio-theme {
            background-color: #f9fafb;
            color: #1f2937;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            overflow: hidden;
            border-radius: 1rem;
        }
        
        .new-portfolio-theme .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .new-portfolio-theme header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            width: 100%;
            z-index: 100;
        }
        
        .new-portfolio-theme nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }
        
        .new-portfolio-theme .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #6366f1;
        }
        
        .new-portfolio-theme .nav-links {
            display: flex;
            list-style: none;
        }
        
        .new-portfolio-theme .nav-links li {
            margin-left: 30px;
        }
        
        .new-portfolio-theme .nav-links a {
            text-decoration: none;
            color: #1f2937;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .new-portfolio-theme .nav-links a:hover {
            color: #6366f1;
        }
        
        .new-portfolio-theme .hero {
            padding: 120px 0 80px;
            text-align: center;
            background: linear-gradient(135deg, #6366f1, #10b981);
            color: white;
        }
        
        .new-portfolio-theme .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 20px;
        }
        
        .new-portfolio-theme .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 30px;
            opacity: 0.9;
        }
        
        .new-portfolio-theme .btn {
            display: inline-block;
            padding: 12px 30px;
            background-color: white;
            color: #6366f1;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .new-portfolio-theme .btn:hover {
            background-color: #f3f4f6;
            transform: translateY(-2px);
        }
        
        .new-portfolio-theme section {
            padding: 80px 0;
        }
        
        .new-portfolio-theme .section-title {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .new-portfolio-theme .section-title h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #1f2937;
        }
        
        .new-portfolio-theme .section-title p {
            color: #6b7280;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .new-portfolio-theme .about-content {
            display: flex;
            align-items: center;
            gap: 50px;
        }
        
        .new-portfolio-theme .about-text {
            flex: 1;
        }
        
        .new-portfolio-theme .about-image {
            flex: 1;
            height: 400px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .new-portfolio-theme .about-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .new-portfolio-theme .skills-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
        }
        
        .new-portfolio-theme .skill-card {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
        }
        
        .new-portfolio-theme .skill-card:hover {
            transform: translateY(-5px);
        }
        
        .new-portfolio-theme .skill-card h3 {
            margin-bottom: 15px;
            color: #6366f1;
        }
        
        .new-portfolio-theme .projects-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .new-portfolio-theme .project-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
        }
        
        .new-portfolio-theme .project-card:hover {
            transform: translateY(-5px);
        }
        
        .new-portfolio-theme .project-image {
            height: 200px;
            background: linear-gradient(145deg, #6366f1, #10b981);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .new-portfolio-theme .project-details {
            padding: 20px;
        }
        
        .new-portfolio-theme .project-details h3 {
            margin-bottom: 10px;
            color: #1f2937;
        }
        
        .new-portfolio-theme .contact-content {
            display: flex;
            gap: 50px;
        }
        
        .new-portfolio-theme .contact-form {
            flex: 1;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .new-portfolio-theme .form-group {
            margin-bottom: 20px;
        }
        
        .new-portfolio-theme .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #1f2937;
        }
        
        .new-portfolio-theme .form-group input,
        .new-portfolio-theme .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 5px;
            font-size: 1rem;
            color: #1f2937;
        }
        
        .new-portfolio-theme .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .new-portfolio-theme .contact-info {
            flex: 1;
        }
        
        .new-portfolio-theme .info-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .new-portfolio-theme .info-icon {
            width: 50px;
            height: 50px;
            background-color: #6366f1;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            font-size: 1.2rem;
        }
        
        .new-portfolio-theme footer {
            background-color: #1f2937;
            color: white;
            padding: 50px 0 20px;
            text-align: center;
        }
        
        .new-portfolio-theme .footer-content {
            margin-bottom: 30px;
        }
        
        .new-portfolio-theme .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .new-portfolio-theme .social-links a {
            color: white;
            font-size: 1.5rem;
            transition: color 0.3s;
        }
        
        .new-portfolio-theme .social-links a:hover {
            color: #10b981;
        }
        
        .new-portfolio-theme .copyright {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #9ca3af;
        }
        
        /* Responsive Design for New Theme */
        @media (max-width: 768px) {
            .new-portfolio-theme .about-content,
            .new-portfolio-theme .contact-content {
                flex-direction: column;
            }
            
            .new-portfolio-theme .hero h1 {
                font-size: 2.5rem;
            }
            
            .new-portfolio-theme .nav-links {
                display: none;
            }
        }
    </style>
</head>
<body class="animated-bg min-h-screen">
    <div class="particles" id="particles"></div>
    
    <!-- Network Status Indicator -->
    <div class="network-status glass">
        <span class="status-indicator" id="statusIndicator"></span>
        <span id="statusText">Checking network...</span>
    </div>
    
    <!-- User Profile Modal -->
    <div id="userProfileModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Create Your Profile</h2>
                <button class="modal-close" onclick="closeUserProfileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="userProfileForm">
                    <div class="mb-4">
                        <label for="userName" class="block mb-2">Name</label>
                        <input type="text" id="userName" class="editor-input" required>
                    </div>
                    <div class="mb-4">
                        <label for="userEmail" class="block mb-2">Email</label>
                        <input type="email" id="userEmail" class="editor-input" required>
                    </div>
                    <div class="mb-4">
                        <label for="userRole" class="block mb-2">Role/Title</label>
                        <input type="text" id="userRole" class="editor-input" placeholder="e.g., Full Stack Developer">
                    </div>
                    <div class="mb-4">
                        <label for="userSkills" class="block mb-2">Skills (comma separated)</label>
                        <input type="text" id="userSkills" class="editor-input" placeholder="e.g., JavaScript, React, Node.js">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="glass px-4 py-2 rounded-lg" onclick="closeUserProfileModal()">Cancel</button>
                <button class="btn-primary text-white font-bold py-3 px-6 rounded-full" onclick="saveUserProfile()">Save Profile</button>
            </div>
        </div>
    </div>
    
    <div class="container mx-auto p-4 md:p-8 max-w-6xl relative z-10">
        <!-- Header -->
        <header class="flex justify-between items-center py-6 mb-8">
            <div class="flex items-center space-x-2">
                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center">
                    <i class="fas fa-briefcase text-white"></i>
                </div>
                <h1 class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-purple-500">PortfolioForge</h1>
            </div>
            <nav>
                <ul class="flex space-x-6">
                    <li><a href="#" onclick="switchView('landingView')" class="text-gray-300 hover:text-white transition-colors">Home</a></li>
                    <li><a href="#" onclick="switchView('featuresView')" class="text-gray-300 hover:text-white transition-colors">Features</a></li>
                    <li><a href="#" onclick="switchView('assessmentDashboardView')" class="text-gray-300 hover:text-white transition-colors">Assessments</a></li>
                    <li><a href="#" onclick="switchView('contactView')" class="text-gray-300 hover:text-white transition-colors">Contact</a></li>
                </ul>
            </nav>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <p class="text-sm text-gray-400">Welcome back,</p>
                    <p class="font-medium" id="headerUserName">Guest</p>
                </div>
                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center cursor-pointer" onclick="openUserProfileModal()">
                    <i class="fas fa-user text-white"></i>
                </div>
            </div>
        </header>
        
        <!-- Landing View -->
        <div id="landingView" class="view">
            <div class="text-center py-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400">
                    Create Your Perfect Portfolio
                </h1>
                <p class="text-lg text-gray-400 mb-12 max-w-2xl mx-auto">
                    Choose your path: let our AI do the heavy lifting or build it yourself from scratch.
                </p>
                
                <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <div class="glass p-8 rounded-2xl border border-indigo-500/30 hover:border-indigo-400/50 transition-all cursor-pointer transform hover:-translate-y-2" onclick="switchView('aiView')">
                        <div class="w-16 h-16 rounded-full bg-gradient-to-r from-indigo-500 to-purple-600 flex items-center justify-center mx-auto mb-6">
                            <i class="fa-solid fa-wand-magic-sparkles text-white text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold mb-2">Create with AI</h2>
                        <p class="text-gray-400">Upload your resume and let our AI instantly generate a beautiful, professional portfolio tailored to you.</p>
                        <div class="mt-6 flex justify-center space-x-2">
                            <span class="px-3 py-1 bg-indigo-900/50 text-indigo-300 rounded-full text-xs">Fast</span>
                            <span class="px-3 py-1 bg-indigo-900/50 text-indigo-300 rounded-full text-xs">Smart</span>
                            <span class="px-3 py-1 bg-indigo-900/50 text-indigo-300 rounded-full text-xs">Professional</span>
                        </div>
                    </div>
                    
                    <div class="glass p-8 rounded-2xl border border-pink-500/30 hover:border-pink-400/50 transition-all cursor-pointer transform hover:-translate-y-2" onclick="switchView('editorView')">
                         <div class="w-16 h-16 rounded-full bg-gradient-to-r from-pink-500 to-rose-600 flex items-center justify-center mx-auto mb-6">
                            <i class="fa-solid fa-pen-ruler text-white text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold mb-2">Build Manually</h2>
                        <p class="text-gray-400">Take full control. Craft your portfolio from the ground up with our intuitive editor.</p>
                        <div class="mt-6 flex justify-center space-x-2">
                            <span class="px-3 py-1 bg-pink-900/50 text-pink-300 rounded-full text-xs">Customizable</span>
                            <span class="px-3 py-1 bg-pink-900/50 text-pink-300 rounded-full text-xs">Flexible</span>
                            <span class="px-3 py-1 bg-pink-900/50 text-pink-300 rounded-full text-xs">Creative</span>
                        </div>
                    </div>
                </div>
                
                <div class="mt-16">
                    <h3 class="text-2xl font-bold mb-6">How It Works</h3>
                    <div class="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                        <div class="glass p-6 rounded-xl">
                            <div class="w-12 h-12 rounded-full bg-indigo-900/50 flex items-center justify-center mx-auto mb-4">
                                <span class="text-indigo-400 font-bold">1</span>
                            </div>
                            <h4 class="font-bold mb-2">Upload or Create</h4>
                            <p class="text-gray-400 text-sm">Upload your resume or start from scratch</p>
                        </div>
                        <div class="glass p-6 rounded-xl">
                            <div class="w-12 h-12 rounded-full bg-purple-900/50 flex items-center justify-center mx-auto mb-4">
                                <span class="text-purple-400 font-bold">2</span>
                            </div>
                            <h4 class="font-bold mb-2">Customize</h4>
                            <p class="text-gray-400 text-sm">Edit content, change themes, add projects</p>
                        </div>
                        <div class="glass p-6 rounded-xl">
                            <div class="w-12 h-12 rounded-full bg-pink-900/50 flex items-center justify-center mx-auto mb-4">
                                <span class="text-pink-400 font-bold">3</span>
                            </div>
                            <h4 class="font-bold mb-2">Share</h4>
                            <p class="text-gray-400 text-sm">Get a unique link to share your portfolio</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-16 glass p-8 rounded-2xl">
                    <h3 class="text-2xl font-bold mb-6">Assess Your Skills</h3>
                    <p class="text-gray-400 mb-8 max-w-2xl mx-auto">
                        Our intelligent assessment system helps you evaluate your skills, track your progress, and receive personalized recommendations for improvement.
                    </p>
                    <button onclick="switchView('assessmentDashboardView')" class="btn-primary text-white font-bold py-3 px-8 rounded-full text-lg">
                        <i class="fas fa-brain mr-2"></i>Try Assessments
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Features View -->
        <div id="featuresView" class="view hidden">
            <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Home
            </button>
            
            <h2 class="text-3xl font-bold mb-6">Features</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-indigo-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-magic text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">AI-Powered Generation</h3>
                    <p class="text-gray-400">Upload your resume and let AI create a professional portfolio in seconds.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-purple-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-palette text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Customizable Themes</h3>
                    <p class="text-gray-400">Choose from multiple professionally designed themes to match your style.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-pink-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-share-nodes text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Easy Sharing</h3>
                    <p class="text-gray-400">Share your portfolio with a unique link, QR code, or on social media.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-green-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-pen text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Manual Editor</h3>
                    <p class="text-gray-400">Take full control with our intuitive editor to build your portfolio from scratch.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-yellow-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-mobile-alt text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Responsive Design</h3>
                    <p class="text-gray-400">Your portfolio looks great on all devices, from desktop to mobile.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-blue-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-cloud text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Cloud Storage</h3>
                    <p class="text-gray-400">Your portfolio is stored securely in the cloud and accessible anywhere.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-red-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-brain text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Intelligent Assessments</h3>
                    <p class="text-gray-400">Evaluate your skills with adaptive testing and receive personalized feedback.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-teal-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-chart-line text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Progress Analytics</h3>
                    <p class="text-gray-400">Track your learning progress with detailed analytics and insights.</p>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <div class="w-16 h-16 rounded-full bg-orange-500 flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-users text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Peer Assessment</h3>
                    <p class="text-gray-400">Get feedback from peers on your portfolio projects and skills.</p>
                </div>
            </div>
            
            <div class="mt-12 glass p-8 rounded-2xl">
                <h3 class="text-2xl font-bold mb-4">Why Choose PortfolioForge?</h3>
                <p class="text-gray-400 mb-6">PortfolioForge combines cutting-edge AI technology with intuitive design tools to help you create a professional portfolio that stands out from the crowd.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-bolt text-indigo-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Lightning Fast</h4>
                            <p class="text-gray-400 text-sm">Create a stunning portfolio in minutes, not hours.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-purple-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-shield-alt text-purple-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Secure & Private</h4>
                            <p class="text-gray-400 text-sm">Your data is encrypted and stored securely.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-pink-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-chart-line text-pink-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Analytics Dashboard</h4>
                            <p class="text-gray-400 text-sm">Track who views your portfolio and from where.</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full bg-green-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                            <i class="fas fa-sync text-green-400"></i>
                        </div>
                        <div>
                            <h4 class="font-bold mb-1">Always Up-to-Date</h4>
                            <p class="text-gray-400 text-sm">Regular updates with new features and improvements.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Assessment Dashboard View -->
        <div id="assessmentDashboardView" class="view hidden">
            <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Home
            </button>
            
            <div class="glass p-8 rounded-2xl mb-8">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
                    <div>
                        <h2 class="text-3xl font-bold mb-2">Learning Dashboard</h2>
                        <p class="text-gray-400">Track your progress and competencies</p>
                    </div>
                    <div class="mt-4 md:mt-0">
                        <button onclick="switchView('assessmentsView')" class="btn-primary text-white font-bold py-3 px-6 rounded-full">
                            <i class="fas fa-plus mr-2"></i>New Assessment
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="glass p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold">Completed Assessments</h3>
                            <div class="w-12 h-12 rounded-full bg-indigo-900/50 flex items-center justify-center">
                                <i class="fas fa-check-circle text-indigo-400 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-3xl font-bold mb-2" id="completedAssessmentsCount">12</p>
                        <p class="text-gray-400 text-sm">+3 from last week</p>
                    </div>
                    
                    <div class="glass p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold">Average Score</h3>
                            <div class="w-12 h-12 rounded-full bg-green-900/50 flex items-center justify-center">
                                <i class="fas fa-chart-line text-green-400 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-3xl font-bold mb-2" id="averageScore">87%</p>
                        <p class="text-gray-400 text-sm">+5% improvement</p>
                    </div>
                    
                    <div class="glass p-6 rounded-xl">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold">Learning Streak</h3>
                            <div class="w-12 h-12 rounded-full bg-yellow-900/50 flex items-center justify-center">
                                <i class="fas fa-fire text-yellow-400 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-3xl font-bold mb-2" id="learningStreak">7 days</p>
                        <p class="text-gray-400 text-sm">Keep it up!</p>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold mb-6">Competency Progress</h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>Web Development</span>
                                <span>85%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-indigo-500" style="width: 85%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>Data Analysis</span>
                                <span>72%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-green-500" style="width: 72%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>UI/UX Design</span>
                                <span>68%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-purple-500" style="width: 68%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>Project Management</span>
                                <span>60%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-pink-500" style="width: 60%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold mb-6">Recent Assessments</h3>
                    <div class="space-y-4" id="recentAssessments">
                        <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                            <div>
                                <h4 class="font-bold">JavaScript Fundamentals</h4>
                                <p class="text-gray-400 text-sm">Completed 2 days ago</p>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="text-right">
                                    <p class="font-bold">92%</p>
                                    <p class="text-green-400 text-sm">Excellent</p>
                                </div>
                                <button class="text-indigo-400 hover:text-indigo-300">
                                    <i class="fas fa-redo"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                            <div>
                                <h4 class="font-bold">React Components</h4>
                                <p class="text-gray-400 text-sm">Completed 5 days ago</p>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="text-right">
                                    <p class="font-bold">78%</p>
                                    <p class="text-yellow-400 text-sm">Good</p>
                                </div>
                                <button class="text-indigo-400 hover:text-indigo-300">
                                    <i class="fas fa-redo"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                            <div>
                                <h4 class="font-bold">Data Visualization</h4>
                                <p class="text-gray-400 text-sm">Completed 1 week ago</p>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="text-right">
                                    <p class="font-bold">65%</p>
                                    <p class="text-orange-400 text-sm">Needs Improvement</p>
                                </div>
                                <button class="text-indigo-400 hover:text-indigo-300">
                                    <i class="fas fa-redo"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Assessments View -->
        <div id="assessmentsView" class="view hidden">
            <button onclick="switchView('assessmentDashboardView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Dashboard
            </button>
            
            <div class="glass p-8 rounded-2xl mb-8">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
                    <div>
                        <h2 class="text-3xl font-bold mb-2">Available Assessments</h2>
                        <p class="text-gray-400">Test your knowledge and get instant feedback</p>
                    </div>
                    <div class="mt-4 md:mt-0">
                        <div class="relative">
                            <input type="text" placeholder="Search assessments..." class="bg-slate-800/50 text-white rounded-full py-2 px-4 pl-10 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('web-dev')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-indigo-900/50 flex items-center justify-center">
                                <i class="fas fa-code text-indigo-400 text-xl"></i>
                            </div>
                            <span class="bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">Web Development</h3>
                        <p class="text-gray-400 mb-4">Test your knowledge of HTML, CSS, and JavaScript fundamentals</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">10 questions • 15 min</span>
                            <span class="text-sm font-medium text-indigo-400">Beginner</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('react')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-blue-900/50 flex items-center justify-center">
                                <i class="fab fa-react text-blue-400 text-xl"></i>
                            </div>
                            <span class="bg-blue-900/50 text-blue-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">React Framework</h3>
                        <p class="text-gray-400 mb-4">Assess your understanding of React components, hooks, and state management</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">10 questions • 12 min</span>
                            <span class="text-sm font-medium text-blue-400">Intermediate</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('data-analysis')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-green-900/50 flex items-center justify-center">
                                <i class="fas fa-chart-bar text-green-400 text-xl"></i>
                            </div>
                            <span class="bg-green-900/50 text-green-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">Data Analysis</h3>
                        <p class="text-gray-400 mb-4">Evaluate your skills in data manipulation, visualization, and interpretation</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">12 questions • 18 min</span>
                            <span class="text-sm font-medium text-green-400">Intermediate</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('ui-ux')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-purple-900/50 flex items-center justify-center">
                                <i class="fas fa-paint-brush text-purple-400 text-xl"></i>
                            </div>
                            <span class="bg-purple-900/50 text-purple-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">UI/UX Design</h3>
                        <p class="text-gray-400 mb-4">Test your knowledge of design principles, user research, and prototyping</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">12 questions • 20 min</span>
                            <span class="text-sm font-medium text-purple-400">Intermediate</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('project-mgmt')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-pink-900/50 flex items-center justify-center">
                                <i class="fas fa-tasks text-pink-400 text-xl"></i>
                            </div>
                            <span class="bg-pink-900/50 text-pink-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">Project Management</h3>
                        <p class="text-gray-400 mb-4">Assess your understanding of agile methodologies and project planning</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">10 questions • 15 min</span>
                            <span class="text-sm font-medium text-pink-400">Advanced</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('javascript-advanced')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-yellow-900/50 flex items-center justify-center">
                                <i class="fab fa-js text-yellow-400 text-xl"></i>
                            </div>
                            <span class="bg-yellow-900/50 text-yellow-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">JavaScript Advanced</h3>
                        <p class="text-gray-400 mb-4">Test your knowledge of advanced JavaScript concepts and patterns</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">10 questions • 15 min</span>
                            <span class="text-sm font-medium text-yellow-400">Advanced</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('css-mastery')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-cyan-900/50 flex items-center justify-center">
                                <i class="fab fa-css3-alt text-cyan-400 text-xl"></i>
                            </div>
                            <span class="bg-cyan-900/50 text-cyan-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">CSS Mastery</h3>
                        <p class="text-gray-400 mb-4">Test your knowledge of advanced CSS techniques and layout methods</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">10 questions • 15 min</span>
                            <span class="text-sm font-medium text-cyan-400">Advanced</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('python-basics')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-blue-900/50 flex items-center justify-center">
                                <i class="fab fa-python text-blue-400 text-xl"></i>
                            </div>
                            <span class="bg-blue-900/50 text-blue-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">Python Basics</h3>
                        <p class="text-gray-400 mb-4">Test your knowledge of Python fundamentals and programming concepts</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">10 questions • 15 min</span>
                            <span class="text-sm font-medium text-blue-400">Beginner</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startAssessment('machine-learning')">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-red-900/50 flex items-center justify-center">
                                <i class="fas fa-robot text-red-400 text-xl"></i>
                            </div>
                            <span class="bg-red-900/50 text-red-300 text-xs px-2 py-1 rounded-full">Adaptive</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">Machine Learning</h3>
                        <p class="text-gray-400 mb-4">Assess your understanding of ML algorithms and concepts</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">12 questions • 20 min</span>
                            <span class="text-sm font-medium text-red-400">Advanced</span>
                        </div>
                    </div>
                    
                    <div class="assessment-card glass p-6 rounded-xl" onclick="startPeerReview()">
                        <div class="flex justify-between items-start mb-4">
                            <div class="w-12 h-12 rounded-full bg-yellow-900/50 flex items-center justify-center">
                                <i class="fas fa-users text-yellow-400 text-xl"></i>
                            </div>
                            <span class="bg-yellow-900/50 text-yellow-300 text-xs px-2 py-1 rounded-full">Peer Review</span>
                        </div>
                        <h3 class="text-xl font-bold mb-2">Portfolio Review</h3>
                        <p class="text-gray-400 mb-4">Get feedback from peers on your portfolio projects and presentation</p>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-400">Peer assessment</span>
                            <span class="text-sm font-medium text-yellow-400">All Levels</span>
                        </div>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-6">Assessment Recommendations</h3>
                    <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg mb-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center mr-4">
                                <i class="fas fa-lightbulb text-indigo-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Based on your learning goals</h4>
                                <p class="text-gray-400 text-sm">We recommend starting with Web Development fundamentals</p>
                            </div>
                        </div>
                        <button onclick="startAssessment('web-dev')" class="btn-primary text-white font-bold py-2 px-4 rounded-full text-sm">
                            Start Now
                        </button>
                    </div>
                    
                    <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-full bg-green-900/50 flex items-center justify-center mr-4">
                                <i class="fas fa-chart-line text-green-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">To improve your Data Analysis skills</h4>
                                <p class="text-gray-400 text-sm">Your recent performance suggests focusing on visualization techniques</p>
                            </div>
                        </div>
                        <button onclick="startAssessment('data-analysis')" class="btn-primary text-white font-bold py-2 px-4 rounded-full text-sm">
                            Start Now
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Assessment Taking View -->
        <div id="assessmentTakingView" class="view hidden">
            <div class="glass p-8 rounded-2xl">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h2 id="assessmentTitle" class="text-3xl font-bold mb-2">Assessment Title</h2>
                        <p id="assessmentDescription" class="text-gray-400">Assessment Description</p>
                    </div>
                    <div class="text-right">
                        <p class="text-gray-400">Time Remaining</p>
                        <p id="timer" class="text-2xl font-bold">25:00</p>
                    </div>
                </div>
                
                <div class="mb-6">
                    <div class="flex justify-between mb-2">
                        <span>Question <span id="currentQuestion">1</span> of <span id="totalQuestions">15</span></span>
                        <span id="difficultyBadge" class="bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded-full">Medium</span>
                    </div>
                    <div class="w-full bg-slate-700 rounded-full h-2.5">
                        <div id="progressBar" class="bg-indigo-600 h-2.5 rounded-full" style="width: 25%"></div>
                    </div>
                </div>
                
                <div id="questionContainer" class="glass p-6 rounded-xl mb-8">
                    <h3 id="questionText" class="text-xl font-bold mb-6">What is the correct way to declare a variable in JavaScript?</h3>
                    <div class="space-y-4">
                        <div class="p-4 bg-slate-800/50 rounded-lg cursor-pointer hover:bg-slate-700/50 transition-colors" onclick="selectOption(0)">
                            <div class="flex items-center">
                                <div class="w-6 h-6 rounded-full border-2 border-slate-500 mr-4 flex items-center justify-center option-radio">
                                    <div class="w-3 h-3 rounded-full bg-indigo-500 hidden"></div>
                                </div>
                                <span>var myVariable = "value";</span>
                            </div>
                        </div>
                        <div class="p-4 bg-slate-800/50 rounded-lg cursor-pointer hover:bg-slate-700/50 transition-colors" onclick="selectOption(1)">
                            <div class="flex items-center">
                                <div class="w-6 h-6 rounded-full border-2 border-slate-500 mr-4 flex items-center justify-center option-radio">
                                    <div class="w-3 h-3 rounded-full bg-indigo-500 hidden"></div>
                                </div>
                                <span>variable myVariable = "value";</span>
                            </div>
                        </div>
                        <div class="p-4 bg-slate-800/50 rounded-lg cursor-pointer hover:bg-slate-700/50 transition-colors" onclick="selectOption(2)">
                            <div class="flex items-center">
                                <div class="w-6 h-6 rounded-full border-2 border-slate-500 mr-4 flex items-center justify-center option-radio">
                                    <div class="w-3 h-3 rounded-full bg-indigo-500 hidden"></div>
                                </div>
                                <span>v myVariable = "value";</span>
                            </div>
                        </div>
                        <div class="p-4 bg-slate-800/50 rounded-lg cursor-pointer hover:bg-slate-700/50 transition-colors" onclick="selectOption(3)">
                            <div class="flex items-center">
                                <div class="w-6 h-6 rounded-full border-2 border-slate-500 mr-4 flex items-center justify-center option-radio">
                                    <div class="w-3 h-3 rounded-full bg-indigo-500 hidden"></div>
                                </div>
                                <span>declare myVariable = "value";</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="feedbackContainer" class="hidden glass p-6 rounded-xl mb-8">
                    <div id="feedbackContent"></div>
                    <button onclick="nextQuestion()" class="btn-primary text-white font-bold py-3 px-6 rounded-full mt-4">
                        Next Question <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
                
                <div class="flex justify-between">
                    <button onclick="exitAssessment()" class="glass px-6 py-3 rounded-lg transition-colors hover:bg-slate-700/50">
                        <i class="fas fa-times mr-2"></i>Exit Assessment
                    </button>
                    <button id="submitAnswerBtn" onclick="submitAnswer()" class="btn-primary text-white font-bold py-3 px-6 rounded-full">
                        Submit Answer <i class="fas fa-check ml-2"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Assessment Results View -->
        <div id="assessmentResultsView" class="view hidden">
            <div class="glass p-8 rounded-2xl">
                <div class="text-center mb-8">
                    <div class="w-24 h-24 rounded-full bg-gradient-to-r from-green-500 to-emerald-600 flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-check text-white text-4xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Assessment Completed!</h2>
                    <p class="text-gray-400">Here's how you performed</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="glass p-6 rounded-xl text-center">
                        <p class="text-gray-400 mb-2">Your Score</p>
                        <p id="scorePercentage" class="text-4xl font-bold text-green-400">87%</p>
                    </div>
                    <div class="glass p-6 rounded-xl text-center">
                        <p class="text-gray-400 mb-2">Correct Answers</p>
                        <p id="correctAnswers" class="text-4xl font-bold text-indigo-400">13/15</p>
                    </div>
                    <div class="glass p-6 rounded-xl text-center">
                        <p class="text-gray-400 mb-2">Time Taken</p>
                        <p id="timeTaken" class="text-4xl font-bold text-purple-400">18:32</p>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold mb-6">Performance by Category</h3>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>JavaScript Basics</span>
                                <span>92%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-indigo-500" style="width: 92%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>DOM Manipulation</span>
                                <span>85%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-green-500" style="width: 85%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>Asynchronous JavaScript</span>
                                <span>78%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-purple-500" style="width: 78%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between mb-1">
                                <span>ES6+ Features</span>
                                <span>65%</span>
                            </div>
                            <div class="skill-bar">
                                <div class="skill-progress bg-pink-500" style="width: 65%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold mb-6">Recommendations</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-book text-indigo-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Study ES6+ Features</h4>
                                <p class="text-gray-400 text-sm">Your performance in this area suggests additional practice would be beneficial</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-green-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-project-diagram text-green-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Practice Projects</h4>
                                <p class="text-gray-400 text-sm">Apply your knowledge by building small projects focusing on async JavaScript</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-purple-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-users text-purple-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Peer Review</h4>
                                <p class="text-gray-400 text-sm">Join a study group to get feedback on your code and approaches</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-center space-x-4">
                    <button onclick="reviewAnswers()" class="glass px-6 py-3 rounded-lg transition-colors hover:bg-slate-700/50">
                        <i class="fas fa-eye mr-2"></i>Review Answers
                    </button>
                    <button onclick="switchView('assessmentAnalyticsView')" class="btn-primary text-white font-bold py-3 px-6 rounded-full">
                        <i class="fas fa-chart-line mr-2"></i>View Analytics
                    </button>
                    <button onclick="switchView('assessmentsView')" class="btn-secondary text-white font-bold py-3 px-6 rounded-full">
                        <i class="fas fa-redo mr-2"></i>Try Another Assessment
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Assessment Review View -->
        <div id="assessmentReviewView" class="view hidden">
            <button onclick="switchView('assessmentResultsView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Results
            </button>
            
            <div class="glass p-8 rounded-2xl">
                <h2 class="text-3xl font-bold mb-6">Assessment Review</h2>
                <p class="text-gray-400 mb-8">Review your answers and learn from explanations</p>
                
                <div id="assessmentReviewContainer" class="space-y-6">
                    <!-- Review items will be dynamically added here -->
                </div>
                
                <div class="flex justify-center mt-8">
                    <button onclick="switchView('assessmentResultsView')" class="btn-primary text-white font-bold py-3 px-6 rounded-full">
                        Back to Results
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Assessment Analytics View -->
        <div id="assessmentAnalyticsView" class="view hidden">
            <button onclick="switchView('assessmentResultsView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Results
            </button>
            
            <div class="glass p-8 rounded-2xl mb-8">
                <h2 class="text-3xl font-bold mb-8">Learning Analytics</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="glass p-6 rounded-xl">
                        <h3 class="text-xl font-bold mb-6">Performance Over Time</h3>
                        <div class="chart-container">
                            <canvas id="performanceChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="glass p-6 rounded-xl">
                        <h3 class="text-xl font-bold mb-6">Skill Distribution</h3>
                        <div class="chart-container">
                            <canvas id="skillChart"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold mb-6">Learning Patterns</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="relative inline-block mb-4">
                                <svg class="progress-ring" width="120" height="120">
                                    <circle
                                        class="text-slate-700"
                                        stroke="currentColor"
                                        stroke-width="8"
                                        fill="transparent"
                                        r="52"
                                        cx="60"
                                        cy="60"
                                    />
                                    <circle
                                        class="progress-ring-circle text-indigo-500"
                                        stroke="currentColor"
                                        stroke-width="8"
                                        stroke-dasharray="327"
                                        stroke-dashoffset="82"
                                        fill="transparent"
                                        r="52"
                                        cx="60"
                                        cy="60"
                                    />
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-2xl font-bold">75%</span>
                                </div>
                            </div>
                            <h4 class="font-bold mb-1">Completion Rate</h4>
                            <p class="text-gray-400 text-sm">You complete 3 out of 4 assessments you start</p>
                        </div>
                        
                        <div class="text-center">
                            <div class="relative inline-block mb-4">
                                <svg class="progress-ring" width="120" height="120">
                                    <circle
                                        class="text-slate-700"
                                        stroke="currentColor"
                                        stroke-width="8"
                                        fill="transparent"
                                        r="52"
                                        cx="60"
                                        cy="60"
                                    />
                                    <circle
                                        class="progress-ring-circle text-green-500"
                                        stroke="currentColor"
                                        stroke-width="8"
                                        stroke-dasharray="327"
                                        stroke-dashoffset="114"
                                        fill="transparent"
                                        r="52"
                                        cx="60"
                                        cy="60"
                                    />
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-2xl font-bold">65%</span>
                                </div>
                            </div>
                            <h4 class="font-bold mb-1">Improvement Rate</h4>
                            <p class="text-gray-400 text-sm">Your scores improve by 65% on retakes</p>
                        </div>
                        
                        <div class="text-center">
                            <div class="relative inline-block mb-4">
                                <svg class="progress-ring" width="120" height="120">
                                    <circle
                                        class="text-slate-700"
                                        stroke="currentColor"
                                        stroke-width="8"
                                        fill="transparent"
                                        r="52"
                                        cx="60"
                                        cy="60"
                                    />
                                    <circle
                                        class="progress-ring-circle text-purple-500"
                                        stroke="currentColor"
                                        stroke-width="8"
                                        stroke-dasharray="327"
                                        stroke-dashoffset="196"
                                        fill="transparent"
                                        r="52"
                                        cx="60"
                                        cy="60"
                                    />
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span class="text-2xl font-bold">40%</span>
                                </div>
                            </div>
                            <h4 class="font-bold mb-1">Peer Engagement</h4>
                            <p class="text-gray-400 text-sm">You engage in 40% more peer reviews than average</p>
                        </div>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl">
                    <h3 class="text-xl font-bold mb-6">Learning Recommendations</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-indigo-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-clock text-indigo-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Optimal Learning Time</h4>
                                <p class="text-gray-400 text-sm">Your performance is 23% better when you study between 10 AM - 12 PM</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-green-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-brain text-green-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Spaced Repetition</h4>
                                <p class="text-gray-400 text-sm">Reviewing concepts after 3 days improves retention by 40%</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-purple-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-users text-purple-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Collaborative Learning</h4>
                                <p class="text-gray-400 text-sm">Your scores improve by 18% when you discuss concepts with peers</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Peer Review List View -->
        <div id="peerReviewListView" class="view hidden">
            <button onclick="switchView('assessmentsView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Assessments
            </button>
            
            <div class="glass p-8 rounded-2xl mb-8">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
                    <div>
                        <h2 class="text-3xl font-bold mb-2">Portfolios for Review</h2>
                        <p class="text-gray-400">Select a portfolio to review</p>
                    </div>
                </div>
                
                <div id="peerReviewListContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Portfolio cards will be added here -->
                </div>
            </div>
        </div>
        
        <!-- Peer Review Taking View -->
        <div id="peerReviewTakingView" class="view hidden">
            <div class="glass p-8 rounded-2xl">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h2 id="peerReviewTitle" class="text-3xl font-bold mb-2">Peer Review</h2>
                        <p id="peerReviewDescription" class="text-gray-400">Reviewing the portfolio of <span id="portfolioOwnerName"></span></p>
                    </div>
                    <div class="text-right" id="peerReviewTimerContainer" style="display: none;">
                        <p class="text-gray-400">Time Remaining</p>
                        <p id="peerReviewTimer" class="text-2xl font-bold">25:00</p>
                    </div>
                </div>
                
                <!-- Portfolio Display Section -->
                <div class="mb-8">
                    <h3 class="text-xl font-bold mb-4">Portfolio Being Reviewed</h3>
                    <div class="portfolio-preview" id="portfolioPreview">
                        <!-- Portfolio preview will be loaded here -->
                    </div>
                </div>
                
                <div class="mb-6">
                    <div class="flex justify-between mb-2">
                        <span>Question <span id="peerReviewCurrentQuestion">1</span> of <span id="peerReviewTotalQuestions">10</span></span>
                        <span id="peerReviewDifficultyBadge" class="bg-indigo-900/50 text-indigo-300 text-xs px-2 py-1 rounded-full">Medium</span>
                    </div>
                    <div class="w-full bg-slate-700 rounded-full h-2.5">
                        <div id="peerReviewProgressBar" class="bg-indigo-600 h-2.5 rounded-full" style="width: 25%"></div>
                    </div>
                </div>
                
                <div id="peerReviewQuestionContainer" class="glass p-6 rounded-xl mb-8">
                    <h3 id="peerReviewQuestionText" class="text-xl font-bold mb-6">What is your overall impression of this portfolio?</h3>
                    <div class="space-y-4" id="peerReviewOptionsContainer">
                        <!-- Options will be loaded here -->
                    </div>
                </div>
                
                <div id="peerReviewFeedbackContainer" class="hidden glass p-6 rounded-xl mb-8">
                    <div id="peerReviewFeedbackContent"></div>
                    <button onclick="peerReviewNextQuestion()" class="btn-primary text-white font-bold py-3 px-6 rounded-full mt-4">
                        Next Question <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
                
                <div class="flex justify-between">
                    <button onclick="exitPeerReview()" class="glass px-6 py-3 rounded-lg transition-colors hover:bg-slate-700/50">
                        <i class="fas fa-times mr-2"></i>Exit Review
                    </button>
                    <button id="peerReviewSubmitAnswerBtn" onclick="peerReviewSubmitAnswer()" class="btn-primary text-white font-bold py-3 px-6 rounded-full">
                        Submit Answer <i class="fas fa-check mr-2"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Peer Review Results View -->
        <div id="peerReviewResultsView" class="view hidden">
            <button onclick="switchView('assessmentsView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Assessments
            </button>
            
            <div class="glass p-8 rounded-2xl">
                <div class="text-center mb-8">
                    <div class="w-24 h-24 rounded-full bg-gradient-to-r from-yellow-500 to-amber-600 flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-star text-white text-4xl"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Peer Review Completed!</h2>
                    <p class="text-gray-400">Thank you for providing valuable feedback</p>
                </div>
                
                <div class="glass p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold mb-6">Your Feedback Summary</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-yellow-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-star text-yellow-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Overall Rating</h4>
                                <div class="rating-stars mb-2">
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="fas fa-star"></i>
                                    <i class="far fa-star"></i>
                                </div>
                                <p class="text-gray-400 text-sm">You rated this portfolio 4 out of 5 stars</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="w-10 h-10 rounded-full bg-yellow-900/50 flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-comment text-yellow-400"></i>
                            </div>
                            <div>
                                <h4 class="font-bold mb-1">Key Feedback Points</h4>
                                <ul class="text-gray-400 text-sm list-disc list-inside">
                                    <li>Excellent project showcase with clear descriptions</li>
                                    <li>Consider adding more technical details to projects</li>
                                    <li>Visual design is clean and professional</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="glass p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold mb-6">Feedback by Category</h3>
                    <div class="space-y-4">
                        <div class="review-category">
                            <h4>Visual Design</h4>
                            <div class="rating-stars mb-2">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                            </div>
                            <p class="text-gray-400 text-sm">"The portfolio has a clean, professional design with good use of color and typography."</p>
                        </div>
                        
                        <div class="review-category">
                            <h4>Content Quality</h4>
                            <div class="rating-stars mb-2">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                            </div>
                            <p class="text-gray-400 text-sm">"Projects are well-described but could benefit from more technical details."</p>
                        </div>
                        
                        <div class="review-category">
                            <h4>Navigation & Structure</h4>
                            <div class="rating-stars mb-2">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="far fa-star"></i>
                            </div>
                            <p class="text-gray-400 text-sm">"Easy to navigate with clear sections. Consider adding a skills section."</p>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-center space-x-4">
                    <button onclick="switchView('assessmentsView')" class="btn-primary text-white font-bold py-3 px-6 rounded-full">
                        <i class="fas fa-check mr-2"></i>Complete Review
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Contact View -->
        <div id="contactView" class="view hidden">
            <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back to Home
            </button>
            
            <h2 class="text-3xl font-bold mb-6">Contact Us</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">Get in Touch</h3>
                    <p class="text-gray-400 mb-6">Have questions or feedback? We'd love to hear from you.</p>
                    
                    <form id="contactForm" class="space-y-4">
                        <div>
                            <label for="contactName" class="block mb-2">Name</label>
                            <input type="text" id="contactName" class="editor-input" required>
                        </div>
                        <div>
                            <label for="contactEmail" class="block mb-2">Email</label>
                            <input type="email" id="contactEmail" class="editor-input" required>
                        </div>
                        <div>
                            <label for="contactMessage" class="block mb-2">Message</label>
                            <textarea id="contactMessage" rows="4" class="editor-input" required></textarea>
                        </div>
                        <button type="submit" class="btn-primary text-white font-bold py-3 px-8 rounded-full">
                            Send Message
                        </button>
                    </form>
                </div>
                
                <div>
                    <h3 class="text-xl font-bold mb-4">Contact Information</h3>
                    
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <i class="fas fa-map-marker-alt text-indigo-400 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-bold">Address</h4>
                                <p class="text-gray-400">123 Portfolio Street, Tech City, TC 12345</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <i class="fas fa-envelope text-indigo-400 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-bold">Email</h4>
                                <p class="text-gray-400">contact@portfolioforge.com</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <i class="fas fa-phone text-indigo-400 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-bold">Phone</h4>
                                <p class="text-gray-400">+1 (555) 123-4567</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <h3 class="text-xl font-bold mb-4">Follow Us</h3>
                        <div class="flex space-x-4">
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-twitter text-white"></i>
                            </a>
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-facebook text-white"></i>
                            </a>
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-linkedin text-white"></i>
                            </a>
                            <a href="#" class="social-link bg-indigo-900/50 hover:bg-indigo-800">
                                <i class="fab fa-instagram text-white"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI View -->
        <div id="aiView" class="view hidden">
            <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                <i class="fa-solid fa-arrow-left mr-2"></i>Back
            </button>
            
            <div id="aiUploader" class="glass p-8 rounded-2xl border border-slate-700">
                <h2 class="text-3xl font-bold text-center mb-2">AI Portfolio Generator</h2>
                <p class="text-gray-400 text-center mb-8">Upload your resume and let AI create your professional portfolio</p>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="form-step">
                        <label class="block font-bold mb-3 text-lg flex items-center">
                            <i class="fas fa-user-circle mr-2 text-indigo-400"></i> Upload Your Photo
                        </label>
                        <div id="photoDropZone" class="drop-zone p-8 text-center rounded-xl cursor-pointer">
                            <i class="fa-solid fa-cloud-arrow-up text-4xl text-gray-500 mb-3"></i>
                            <p id="photoLabel" class="text-gray-400">Click or drag photo here</p>
                            <p class="text-xs text-gray-500 mt-2">JPG, PNG up to 5MB</p>
                        </div>
                        <input type="file" id="photoInput" accept="image/*" class="hidden">
                    </div>
                    
                    <div class="form-step">
                        <label class="block font-bold mb-3 text-lg flex items-center">
                            <i class="fas fa-file-pdf mr-2 text-rose-400"></i> Upload Your Resume
                        </label>
                        <div id="resumeDropZone" class="drop-zone p-8 text-center rounded-xl cursor-pointer">
                            <i class="fa-solid fa-cloud-arrow-up text-4xl text-gray-500 mb-3"></i>
                            <p id="resumeLabel" class="text-gray-400">Click or drag resume here</p>
                            <p class="text-xs text-gray-500 mt-2">PDF only, up to 10MB</p>
                        </div>
                        <input type="file" id="resumeInput" accept=".pdf" class="hidden">
                    </div>
                </div>
                
                <div class="text-center mt-10">
                    <button id="generateBtn" class="btn-primary text-white font-bold py-3 px-8 rounded-full text-lg transition-all">
                        <i class="fa-solid fa-wand-magic-sparkles mr-2"></i>Generate My Portfolio
                    </button>
                </div>
            </div>
            
            <div id="aiLoading" class="hidden text-center py-12">
                 <div class="inline-block relative">
                    <div class="w-16 h-16 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin mx-auto"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <i class="fas fa-magic text-indigo-400 animate-pulse"></i>
                    </div>
                 </div>
                 <h3 class="text-2xl font-bold mt-6">AI is building your masterpiece...</h3>
                 <p class="text-gray-400 mt-2 max-w-md mx-auto">Analyzing your resume and designing your personalized portfolio</p>
                 <div class="mt-6 flex justify-center space-x-2">
                    <div class="w-3 h-3 rounded-full bg-indigo-500 animate-bounce" style="animation-delay: 0.1s"></div>
                    <div class="w-3 h-3 rounded-full bg-purple-500 animate-bounce" style="animation-delay: 0.2s"></div>
                    <div class="w-3 h-3 rounded-full bg-pink-500 animate-bounce" style="animation-delay: 0.3s"></div>
                 </div>
            </div>
        </div>
        
        <!-- Editor View -->
        <div id="editorView" class="view hidden">
             <button onclick="switchView('landingView')" class="mb-6 glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                 <i class="fa-solid fa-arrow-left mr-2"></i>Back
             </button>
             
             <h2 class="text-3xl font-bold mb-6 flex items-center">
                 <i class="fas fa-edit mr-3 text-indigo-400"></i>Portfolio Editor
             </h2>
             
             <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                 <div class="lg:col-span-2 space-y-6">
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-user mr-2 text-indigo-400"></i> Personal Information
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <input type="text" id="edit-name" placeholder="Full Name" class="editor-input">
                            <input type="email" id="edit-email" placeholder="Email Address" class="editor-input">
                            <input type="text" id="edit-phone" placeholder="Phone Number" class="editor-input">
                            <input type="text" id="edit-website" placeholder="Website URL" class="editor-input">
                            <input type="text" id="edit-linkedin" placeholder="LinkedIn Username (e.g., johndoe)" class="editor-input">
                            <input type="text" id="edit-github" placeholder="GitHub Username (e.g., johndoe)" class="editor-input">
                        </div>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-file-lines mr-2 text-purple-400"></i> Professional Summary
                        </h3>
                        <textarea id="edit-summary" placeholder="Write a brief summary about yourself..." rows="4" class="editor-input"></textarea>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-code mr-2 text-pink-400"></i> Skills
                        </h3>
                        <input type="text" id="edit-skills" placeholder="Enter skills, comma separated (e.g., JavaScript, React, Figma)" class="editor-input">
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-briefcase mr-2 text-green-400"></i> Work Experience
                        </h3>
                        <div id="experienceContainer" class="space-y-4">
                            <!-- Experience items will be added here dynamically -->
                        </div>
                        <button onclick="addExperience()" class="mt-4 text-sm text-indigo-400 hover:text-indigo-300 flex items-center">
                            <i class="fas fa-plus-circle mr-1"></i> Add Experience
                        </button>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-folder-open mr-2 text-yellow-400"></i> Projects
                        </h3>
                        <div id="projectsContainer" class="space-y-4">
                            <!-- Project items will be added here dynamically -->
                        </div>
                        <button onclick="addProject()" class="mt-4 text-sm text-indigo-400 hover:text-indigo-300 flex items-center">
                            <i class="fas fa-plus-circle mr-1"></i> Add Project
                        </button>
                    </div>
                 </div>
                 
                 <div class="lg:col-span-1 space-y-6">
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-palette mr-2 text-rose-400"></i> Theme Selection
                        </h3>
                        <div class="space-y-4">
                            <div class="theme-option p-4 rounded-xl bg-gray-800" data-theme="Software Developer">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-blue-500 mr-3"></div>
                                    <h4 class="font-bold">Developer Dark</h4>
                                </div>
                                <p class="text-sm text-gray-400">Perfect for software developers and engineers</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gray-100 text-gray-800" data-theme="Graphic Designer">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-pink-500 mr-3"></div>
                                    <h4 class="font-bold">Designer Light</h4>
                                </div>
                                <p class="text-sm text-gray-600">Ideal for designers and creative professionals</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gray-800" data-theme="Data Scientist">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-green-500 mr-3"></div>
                                    <h4 class="font-bold">Data Green</h4>
                                </div>
                                <p class="text-sm text-gray-400">Great for data scientists and analysts</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gray-800" data-theme="Default">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-indigo-600 mr-3"></div>
                                    <h4 class="font-bold">Professional Blue</h4>
                                </div>
                                <p class="text-sm text-gray-400">Clean and professional for any industry</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-white text-gray-800" data-theme="Minimalist">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-gray-300 mr-3"></div>
                                    <h4 class="font-bold">Minimalist</h4>
                                </div>
                                <p class="text-sm text-gray-600">Clean and minimal with lots of white space</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gray-900" data-theme="Dark Mode">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-gray-600 mr-3"></div>
                                    <h4 class="font-bold">Dark Mode</h4>
                                </div>
                                <p class="text-sm text-gray-400">High contrast dark theme for modern look</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gradient-to-br from-pink-100 to-purple-100 text-purple-900" data-theme="Creative">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-purple-500 mr-3"></div>
                                    <h4 class="font-bold">Creative</h4>
                                </div>
                                <p class="text-sm text-purple-800">Vibrant and colorful for creative professionals</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-slate-50 text-slate-800" data-theme="Corporate">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-slate-600 mr-3"></div>
                                    <h4 class="font-bold">Corporate</h4>
                                </div>
                                <p class="text-sm text-slate-700">Professional and clean for corporate environments</p>
                            </div>
                            
                            <div class="theme-option p-4 rounded-xl bg-gradient-to-br from-emerald-50 to-cyan-50 text-emerald-900" data-theme="Nature">
                                <div class="flex items-center mb-2">
                                    <div class="w-8 h-8 rounded-full bg-emerald-500 mr-3"></div>
                                    <h4 class="font-bold">Nature</h4>
                                </div>
                                <p class="text-sm text-emerald-800">Fresh and nature-inspired design</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="editor-section">
                        <h3 class="text-xl font-bold mb-4 flex items-center">
                            <i class="fas fa-image mr-2 text-cyan-400"></i> Profile Photo
                        </h3>
                        <div class="flex flex-col items-center">
                            <div id="profilePhotoPreview" class="w-32 h-32 rounded-full bg-gray-700 flex items-center justify-center mb-4 overflow-hidden">
                                <i class="fas fa-user text-gray-500 text-3xl"></i>
                            </div>
                            <div class="drop-zone p-4 text-center rounded-lg cursor-pointer w-full">
                                <i class="fas fa-cloud-arrow-up text-gray-500 mb-1"></i>
                                <p class="text-sm text-gray-400">Upload Photo</p>
                            </div>
                            <input type="file" id="editorPhotoInput" accept="image/*" class="hidden">
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button id="saveAndPreviewBtn" onclick="saveAndPreview()" class="btn-secondary text-white font-bold py-3 px-8 rounded-full text-lg w-full">
                            <i class="fas fa-eye mr-2"></i>Save & Preview
                        </button>
                    </div>
                 </div>
             </div>
        </div>
        
        <!-- Portfolio View -->
        <div id="portfolioView" class="view hidden">
            <div class="flex flex-wrap gap-4 items-center mb-6">
                 <button onclick="handleBackToEditor()" class="glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                     <i class="fa-solid fa-arrow-left mr-2"></i>Back to Editor
                 </button>
                 
                 <button onclick="sharePortfolio()" class="glass px-4 py-2 rounded-lg transition-colors hover:bg-slate-700/50">
                     <i class="fas fa-share-nodes mr-2"></i>Share Portfolio
                 </button>
                 
                 <div class="ml-auto flex items-center space-x-2">
                     <span class="text-sm text-gray-400">Your portfolio is live at:</span>
                     <div class="glass px-3 py-1 rounded-lg flex items-center">
                         <span id="portfolioLink" class="text-sm font-mono text-indigo-400"></span>
                         <button onclick="copyLink()" class="ml-2 text-gray-400 hover:text-white">
                             <i class="fas fa-copy"></i>
                         </button>
                     </div>
                 </div>
            </div>
            
            <div id="portfolioDisplay" class="glass p-6 md:p-8 rounded-2xl shadow-2xl transition-all duration-500">
                <!-- Portfolio content will be rendered here -->
            </div>
            
            <!-- QR Code and Social Sharing Section -->
            <div class="mt-8 glass p-6 rounded-2xl">
                <h3 class="text-xl font-bold mb-6 text-center">Share Your Portfolio</h3>
                
                <div class="flex flex-col md:flex-row items-center justify-between gap-8">
                    <div class="qr-section">
                        <div class="qr-container" id="qrcode"></div>
                        <p class="qr-info">Scan QR code to share</p>
                    </div>
                    
                    <div class="flex flex-col items-center">
                        <p class="text-lg font-medium mb-4">Share on social media</p>
                        <div class="flex justify-center space-x-4">
                            <a href="#" id="share-twitter" class="text-blue-400 hover:text-blue-300" target="_blank">
                                <i class="fab fa-twitter text-2xl"></i>
                            </a>
                            <a href="#" id="share-facebook" class="text-blue-600 hover:text-blue-500" target="_blank">
                                <i class="fab fa-facebook text-2xl"></i>
                            </a>
                            <a href="#" id="share-linkedin" class="text-blue-700 hover:text-blue-600" target="_blank">
                                <i class="fab fa-linkedin text-2xl"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="flex flex-col items-center">
                        <p class="text-lg font-medium mb-4">Direct link</p>
                        <div class="glass px-4 py-2 rounded-lg flex items-center">
                            <span id="directLink" class="text-sm font-mono text-indigo-400"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-6 right-6 glass px-6 py-3 rounded-lg shadow-lg transform translate-y-20 transition-transform duration-300 flex items-center">
        <i id="toastIcon" class="fas fa-check-circle text-green-500 mr-3"></i>
        <span id="toastMessage">Notification</span>
    </div>
    
    <script>
        // --- GLOBAL STATE & CONSTANTS ---
        // Determine the API URL based on the current environment
        const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:3000'
            : 'https://portfolioforge-backend.onrender.com'; // Replace with your deployed backend URL
        
        let SHAREABLE_URL = ''; // Will be set to the IP-based URL
        let PUBLIC_URL = ''; // Will be set to a public URL (like ngrok)
        let portfolioData = {};
        let profilePictureUrl = '';
        let currentView = 'landingView';
        let portfolioId = '';
        let selectedTheme = 'Default';
        
        // Assessment system state
        let currentAssessment = null;
        let currentQuestionIndex = 0;
        let selectedOption = null;
        let assessmentTimer = null;
        let timeRemaining = 0;
        let userAnswers = [];
        let assessmentResults = [];
        
        // Peer review system state
        let currentPortfolioForReview = null;
        let peerReviewTimer = null;
        let peerReviewTimeRemaining = 0;
        let peerReviewUserAnswers = [];
        let peerReviewRatings = {
            overall: 0,
            visualDesign: 0,
            contentQuality: 0,
            navigationStructure: 0
        };
        let peerReviewComments = {
            strengths: '',
            improvements: '',
            additional: ''
        };
        
        // Student database (simulated)
        let studentDatabase = {
            students: [],
            assessments: [],
            results: [],
            portfolios: []
        };
        
        // Current user state
        let currentUser = null;
        
        // Chart instances
        let performanceChart = null;
        let skillChart = null;
        
        // --- DOM ELEMENT REFERENCES ---
        const views = {
            landingView: document.getElementById('landingView'),
            featuresView: document.getElementById('featuresView'),
            contactView: document.getElementById('contactView'),
            aiView: document.getElementById('aiView'),
            editorView: document.getElementById('editorView'),
            portfolioView: document.getElementById('portfolioView'),
            assessmentDashboardView: document.getElementById('assessmentDashboardView'),
            assessmentsView: document.getElementById('assessmentsView'),
            assessmentTakingView: document.getElementById('assessmentTakingView'),
            assessmentResultsView: document.getElementById('assessmentResultsView'),
            assessmentReviewView: document.getElementById('assessmentReviewView'),
            assessmentAnalyticsView: document.getElementById('assessmentAnalyticsView'),
            peerReviewListView: document.getElementById('peerReviewListView'),
            peerReviewTakingView: document.getElementById('peerReviewTakingView'),
            peerReviewResultsView: document.getElementById('peerReviewResultsView'),
        };
        
        const aiUploader = document.getElementById('aiUploader');
        const aiLoading = document.getElementById('aiLoading');
        const photoInput = document.getElementById('photoInput');
        const resumeInput = document.getElementById('resumeInput');
        const photoDropZone = document.getElementById('photoDropZone');
        const resumeDropZone = document.getElementById('resumeDropZone');
        const generateBtn = document.getElementById('generateBtn');
        const portfolioDisplay = document.getElementById('portfolioDisplay');
        const portfolioLink = document.getElementById('portfolioLink');
        const directLink = document.getElementById('directLink');
        const saveAndPreviewBtn = document.getElementById('saveAndPreviewBtn');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        const toastIcon = document.getElementById('toastIcon');
        const statusIndicator = document.getElementById('statusIndicator');
        const statusText = document.getElementById('statusText');
        const contactForm = document.getElementById('contactForm');
        const userProfileModal = document.getElementById('userProfileModal');
        const userProfileForm = document.getElementById('userProfileForm');
        const headerUserName = document.getElementById('headerUserName');
        const completedAssessmentsCount = document.getElementById('completedAssessmentsCount');
        const averageScore = document.getElementById('averageScore');
        const learningStreak = document.getElementById('learningStreak');
        const recentAssessments = document.getElementById('recentAssessments');
        const assessmentReviewContainer = document.getElementById('assessmentReviewContainer');
        const peerReviewListContainer = document.getElementById('peerReviewListContainer');
        const portfolioPreview = document.getElementById('portfolioPreview');
        
        // --- THEMES DEFINITION ---
        const themes = {
            'Default': {
                background: 'bg-gray-900',
                font: 'font-sans',
                textColor: 'text-gray-100',
                primaryColor: 'text-indigo-500',
                secondaryColor: 'text-purple-400',
                card: 'bg-gray-800'
            },
            'Software Developer': {
                background: 'bg-gray-900',
                font: 'font-mono',
                textColor: 'text-gray-100',
                primaryColor: 'text-blue-500',
                secondaryColor: 'text-blue-400',
                card: 'bg-gray-800'
            },
            'Graphic Designer': {
                background: 'bg-white',
                font: 'font-sans',
                textColor: 'text-gray-900',
                primaryColor: 'text-pink-500',
                secondaryColor: 'text-pink-400',
                card: 'bg-gray-100'
            },
            'Data Scientist': {
                background: 'bg-gray-900',
                font: 'font-sans',
                textColor: 'text-gray-100',
                primaryColor: 'text-green-500',
                secondaryColor: 'text-green-400',
                card: 'bg-gray-800'
            },
            'Minimalist': {
                background: 'bg-white',
                font: 'font-sans',
                textColor: 'text-gray-900',
                primaryColor: 'text-gray-800',
                secondaryColor: 'text-gray-600',
                card: 'bg-gray-50'
            },
            'Dark Mode': {
                background: 'bg-gray-900',
                font: 'font-sans',
                textColor: 'text-gray-100',
                primaryColor: 'text-indigo-400',
                secondaryColor: 'text-purple-400',
                card: 'bg-gray-800'
            },
            'Creative': {
                background: 'bg-gradient-to-br from-pink-100 to-purple-100',
                font: 'font-sans',
                textColor: 'text-purple-900',
                primaryColor: 'text-pink-600',
                secondaryColor: 'text-purple-600',
                card: 'bg-white/80'
            },
            'Corporate': {
                background: 'bg-slate-50',
                font: 'font-sans',
                textColor: 'text-slate-800',
                primaryColor: 'text-slate-800',
                secondaryColor: 'text-slate-600',
                card: 'bg-white'
            },
            'Nature': {
                background: 'bg-gradient-to-br from-emerald-50 to-cyan-50',
                font: 'font-sans',
                textColor: 'text-emerald-900',
                primaryColor: 'text-emerald-700',
                secondaryColor: 'text-cyan-700',
                card: 'bg-white/90'
            }
        };
        
        // --- ASSESSMENT DATA ---
        const assessments = {
            'web-dev': {
                title: 'Web Development Fundamentals',
                description: 'Test your knowledge of HTML, CSS, and JavaScript',
                timeLimit: 15, // Reduced from 30 to 15 minutes
                questions: [
                    {
                        text: 'What is the correct way to declare a variable in JavaScript?',
                        options: [
                            'var myVariable = "value";',
                            'variable myVariable = "value";',
                            'v myVariable = "value";',
                            'declare myVariable = "value";'
                        ],
                        correctAnswer: 0,
                        explanation: 'The var keyword is used to declare a variable in JavaScript. The correct syntax is var myVariable = value.',
                        difficulty: 'easy',
                        category: 'JavaScript Basics'
                    },
                    {
                        text: 'Which HTML tag is used to define an internal style sheet?',
                        options: [
                            '<style>',
                            '<css>',
                            '<script>',
                            '<stylesheet>'
                        ],
                        correctAnswer: 0,
                        explanation: 'The <style> tag is used in HTML to define an internal style sheet.',
                        difficulty: 'easy',
                        category: 'HTML'
                    },
                    {
                        text: 'How do you select an element with the id "header" in CSS?',
                        options: [
                            '#header',
                            '.header',
                            'header',
                            '*header'
                        ],
                        correctAnswer: 0,
                        explanation: 'In CSS, the # symbol is used to select elements by their id. So #header selects the element with id="header".',
                        difficulty: 'easy',
                        category: 'CSS'
                    },
                    {
                        text: 'What does DOM stand for?',
                        options: [
                            'Document Object Model',
                            'Data Object Management',
                            'Digital Output Model',
                            'Document Orientation Model'
                        ],
                        correctAnswer: 0,
                        explanation: 'DOM stands for Document Object Model, which is a programming interface for HTML documents.',
                        difficulty: 'medium',
                        category: 'JavaScript Basics'
                    },
                    {
                        text: 'Which JavaScript method is used to add an element to the end of an array?',
                        options: [
                            'push()',
                            'append()',
                            'add()',
                            'concat()'
                        ],
                        correctAnswer: 0,
                        explanation: 'The push() method adds one or more elements to the end of an array and returns the new length of the array.',
                        difficulty: 'medium',
                        category: 'JavaScript Basics'
                    },
                    {
                        text: 'What is the purpose of the CSS box model?',
                        options: [
                            'To define the design and layout of elements',
                            'To create animations',
                            'To style text',
                            'To add interactivity'
                        ],
                        correctAnswer: 0,
                        explanation: 'The CSS box model is essentially a box that wraps around every HTML element. It consists of: content, padding, borders and margins.',
                        difficulty: 'medium',
                        category: 'CSS'
                    },
                    {
                        text: 'Which HTML attribute specifies an alternate text for an image?',
                        options: [
                            'alt',
                            'title',
                            'src',
                            'longdesc'
                        ],
                        correctAnswer: 0,
                        explanation: 'The alt attribute provides alternative information for an image if a user cannot view it.',
                        difficulty: 'easy',
                        category: 'HTML'
                    },
                    {
                        text: 'What is the correct way to create a function in JavaScript?',
                        options: [
                            'function myFunction() {}',
                            'create myFunction() {}',
                            'def myFunction() {}',
                            'func myFunction() {}'
                        ],
                        correctAnswer: 0,
                        explanation: 'Functions in JavaScript are defined with the function keyword, followed by the function name and parentheses.',
                        difficulty: 'easy',
                        category: 'JavaScript Basics'
                    },
                    {
                        text: 'Which CSS property is used to change the text color?',
                        options: [
                            'color',
                            'text-color',
                            'font-color',
                            'text-style'
                        ],
                        correctAnswer: 0,
                        explanation: 'The color property is used to set the color of text.',
                        difficulty: 'easy',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the correct way to write a JavaScript array?',
                        options: [
                            'var colors = ["red", "green", "blue"];',
                            'var colors = "red", "green", "blue";',
                            'var colors = (1:"red", 2:"green", 3:"blue");',
                            'var colors = {"red", "green", "blue"};'
                        ],
                        correctAnswer: 0,
                        explanation: 'JavaScript arrays are written with square brackets and array items are separated by commas.',
                        difficulty: 'easy',
                        category: 'JavaScript Basics'
                    }
                ]
            },
            'react': {
                title: 'React Framework',
                description: 'Assess your understanding of React components, hooks, and state management',
                timeLimit: 12, // Reduced from 25 to 12 minutes
                questions: [
                    {
                        text: 'What is JSX in React?',
                        options: [
                            'A syntax extension for JavaScript that allows writing HTML-like code in JavaScript',
                            'A JavaScript library for building user interfaces',
                            'A tool for bundling JavaScript modules',
                            'A testing framework for React applications'
                        ],
                        correctAnswer: 0,
                        explanation: 'JSX is a syntax extension for JavaScript that allows writing HTML-like code in JavaScript. It makes it easier to write and add HTML in React.',
                        difficulty: 'easy',
                        category: 'React Basics'
                    },
                    {
                        text: 'Which hook is used to manage state in a functional component?',
                        options: [
                            'useState',
                            'useEffect',
                            'useContext',
                            'useReducer'
                        ],
                        correctAnswer: 0,
                        explanation: 'The useState hook is used to add state to functional components in React.',
                        difficulty: 'easy',
                        category: 'React Hooks'
                    },
                    {
                        text: 'What is the purpose of the useEffect hook?',
                        options: [
                            'To perform side effects in functional components',
                            'To manage state in functional components',
                            'To create context in React',
                            'To optimize performance in React'
                        ],
                        correctAnswer: 0,
                        explanation: 'The useEffect hook lets you perform side effects in functional components. It serves the same purpose as componentDidMount, componentDidUpdate, and componentWillUnmount in React classes.',
                        difficulty: 'medium',
                        category: 'React Hooks'
                    },
                    {
                        text: 'How do you pass data from a parent component to a child component in React?',
                        options: [
                            'Using props',
                            'Using state',
                            'Using context',
                            'Using refs'
                        ],
                        correctAnswer: 0,
                        explanation: 'Props are used to pass data from a parent component to a child component in React.',
                        difficulty: 'easy',
                        category: 'React Basics'
                    },
                    {
                        text: 'What is a virtual DOM in React?',
                        options: [
                            'A lightweight copy of the actual DOM',
                            'A real DOM element',
                            'A testing tool',
                            'A state management tool'
                        ],
                        correctAnswer: 0,
                        explanation: 'The virtual DOM is a lightweight copy of the actual DOM. React uses it to improve performance by minimizing direct manipulation of the DOM.',
                        difficulty: 'medium',
                        category: 'React Concepts'
                    },
                    {
                        text: 'Which method is used to change the state in a class component?',
                        options: [
                            'this.setState()',
                            'this.changeState()',
                            'this.updateState()',
                            'this.modifyState()'
                        ],
                        correctAnswer: 0,
                        explanation: 'The setState() method is used to update the state of a component in React class components.',
                        difficulty: 'easy',
                        category: 'React Class Components'
                    },
                    {
                        text: 'What is the purpose of keys in React lists?',
                        options: [
                            'To help React identify which items have changed, are added, or are removed',
                            'To style list items',
                            'To add event listeners to list items',
                            'To make lists scrollable'
                        ],
                        correctAnswer: 0,
                        explanation: 'Keys help React identify which items have changed, are added, or are removed, and should be given to the elements inside an array to give the elements a stable identity.',
                        difficulty: 'medium',
                        category: 'React Lists'
                    },
                    {
                        text: 'What is React Router used for?',
                        options: [
                            'Handling routing in a React application',
                            'Styling React components',
                            'Managing state in React',
                            'Testing React components'
                        ],
                        correctAnswer: 0,
                        explanation: 'React Router is a standard library for routing in React. It enables navigation between views from different components in a React application.',
                        difficulty: 'easy',
                        category: 'React Ecosystem'
                    },
                    {
                        text: 'What is the purpose of the useRef hook?',
                        options: [
                            'To access DOM elements directly',
                            'To manage state in functional components',
                            'To perform side effects',
                            'To create context'
                        ],
                        correctAnswer: 0,
                        explanation: 'The useRef hook returns a mutable ref object whose .current property is initialized to the passed argument. It is primarily used to access DOM elements directly.',
                        difficulty: 'medium',
                        category: 'React Hooks'
                    },
                    {
                        text: 'What is a higher-order component (HOC) in React?',
                        options: [
                            'A function that takes a component and returns a new component with additional props',
                            'A component that renders other components',
                            'A component with higher state',
                            'A component that uses hooks'
                        ],
                        correctAnswer: 0,
                        explanation: 'A higher-order component is a function that takes a component and returns a new component with additional props or behavior.',
                        difficulty: 'advanced',
                        category: 'React Patterns'
                    }
                ]
            },
            'data-analysis': {
                title: 'Data Analysis Fundamentals',
                description: 'Evaluate your skills in data manipulation, visualization, and interpretation',
                timeLimit: 18, // Reduced from 35 to 18 minutes
                questions: [
                    {
                        text: 'What is the primary purpose of data cleaning?',
                        options: [
                            'To remove errors and inconsistencies from data',
                            'To visualize data for better understanding',
                            'To perform statistical analysis on data',
                            'To store data in a database'
                        ],
                        correctAnswer: 0,
                        explanation: 'Data cleaning is the process of detecting and correcting (or removing) corrupt or inaccurate records from a record set, table, or database.',
                        difficulty: 'easy',
                        category: 'Data Processing'
                    },
                    {
                        text: 'Which type of chart is best for showing the distribution of a continuous variable?',
                        options: [
                            'Histogram',
                            'Bar chart',
                            'Pie chart',
                            'Line chart'
                        ],
                        correctAnswer: 0,
                        explanation: 'A histogram is used to show the distribution of a continuous variable. It groups numbers into ranges (bins) and displays the count of values in each bin.',
                        difficulty: 'medium',
                        category: 'Data Visualization'
                    },
                    {
                        text: 'What does correlation measure?',
                        options: [
                            'The strength and direction of a linear relationship between two variables',
                            'The difference between the mean and median of a dataset',
                            'The spread of data points around the mean',
                            'The proportion of variance explained by a model'
                        ],
                        correctAnswer: 0,
                        explanation: 'Correlation measures the strength and direction of a linear relationship between two variables. It ranges from -1 to 1, where -1 is a perfect negative correlation, 0 is no correlation, and 1 is a perfect positive correlation.',
                        difficulty: 'medium',
                        category: 'Statistics'
                    },
                    {
                        text: 'What is the difference between data and information?',
                        options: [
                            'Data is raw facts, while information is processed data that is meaningful',
                            'Data is processed, while information is raw',
                            'They are the same thing',
                            'Data is qualitative, while information is quantitative'
                        ],
                        correctAnswer: 0,
                        explanation: 'Data is raw, unorganized facts that need to be processed. Information is data that has been processed in such a way as to be meaningful to the person who receives it.',
                        difficulty: 'easy',
                        category: 'Data Concepts'
                    },
                    {
                        text: 'What is the purpose of exploratory data analysis (EDA)?',
                        options: [
                            'To summarize main characteristics of data using visual methods',
                            'To test hypotheses',
                            'To build predictive models',
                            'To clean data'
                        ],
                        correctAnswer: 0,
                        explanation: 'Exploratory data analysis is an approach to analyze data sets to summarize their main characteristics, often using visual methods.',
                        difficulty: 'medium',
                        category: 'Data Analysis'
                    },
                    {
                        text: 'What is a pivot table used for?',
                        options: [
                            'To summarize and reorganize selected columns and rows of data',
                            'To create a project schedule',
                            'To manage project risks',
                            'To communicate with stakeholders'
                        ],
                        correctAnswer: 0,
                        explanation: 'A pivot table is a data summarization tool that is used in spreadsheet programs and other data analysis software.',
                        difficulty: 'easy',
                        category: 'Data Manipulation'
                    },
                    {
                        text: 'What is the difference between structured and unstructured data?',
                        options: [
                            'Structured data is organized in a predefined manner, while unstructured data has no predefined format',
                            'Structured data is qualitative, while unstructured data is quantitative',
                            'They are the same thing',
                            'Structured data is small, while unstructured data is large'
                        ],
                        correctAnswer: 0,
                        explanation: 'Structured data is organized in a predefined manner, typically in rows and columns, while unstructured data has no predefined format and can include text, images, videos, etc.',
                        difficulty: 'medium',
                        category: 'Data Types'
                    },
                    {
                        text: 'What is the purpose of data normalization?',
                        options: [
                            'To rescale numeric columns to a standard range without distorting differences',
                            'To clean data',
                            'To visualize data',
                            'To test hypotheses'
                        ],
                        correctAnswer: 0,
                        explanation: 'Data normalization is a technique used to rescale numeric columns to a standard range, typically between 0 and 1, without distorting differences in the ranges of values.',
                        difficulty: 'medium',
                        category: 'Data Preprocessing'
                    },
                    {
                        text: 'What is a box plot used for?',
                        options: [
                            'To display the distribution of data based on a five-number summary',
                            'To show trends over time',
                            'To compare parts of a whole',
                            'To show correlation between two variables'
                        ],
                        correctAnswer: 0,
                        explanation: 'A box plot is a standardized way of displaying the distribution of data based on a five-number summary: minimum, first quartile, median, third quartile, and maximum.',
                        difficulty: 'medium',
                        category: 'Data Visualization'
                    },
                    {
                        text: 'What is the difference between population and sample in statistics?',
                        options: [
                            'Population includes all members of a specified group, while sample is a subset of the population',
                            'Population is small, while sample is large',
                            'They are the same thing',
                            'Population is for numerical data, while sample is for categorical data'
                        ],
                        correctAnswer: 0,
                        explanation: 'Population includes all members of a specified group, while sample is a subset of the population that is used to represent the entire group.',
                        difficulty: 'easy',
                        category: 'Statistics'
                    },
                    {
                        text: 'What is the purpose of a scatter plot?',
                        options: [
                            'To show the relationship between two numerical variables',
                            'To display the distribution of a single variable',
                            'To compare parts of a whole',
                            'To show trends over time'
                        ],
                        correctAnswer: 0,
                        explanation: 'A scatter plot is a type of plot that uses Cartesian coordinates to display values for typically two variables for a set of data.',
                        difficulty: 'easy',
                        category: 'Data Visualization'
                    },
                    {
                        text: 'What is the difference between mean, median, and mode?',
                        options: [
                            'Mean is the average, median is the middle value, and mode is the most frequent value',
                            'Mean is the middle value, median is the average, and mode is the most frequent value',
                            'They are all the same thing',
                            'Mean is for numerical data, while median and mode are for categorical data'
                        ],
                        correctAnswer: 0,
                        explanation: 'Mean is the average of all values, median is the middle value when data is ordered, and mode is the most frequently occurring value.',
                        difficulty: 'easy',
                        category: 'Statistics'
                    }
                ]
            },
            'ui-ux': {
                title: 'UI/UX Design',
                description: 'Test your knowledge of design principles, user research, and prototyping',
                timeLimit: 20, // Reduced from 40 to 20 minutes
                questions: [
                    {
                        text: 'What is the primary goal of UX design?',
                        options: [
                            'To make products usable, useful, and enjoyable for users',
                            'To make products look visually appealing',
                            'To make products technically efficient',
                            'To make products profitable'
                        ],
                        correctAnswer: 0,
                        explanation: 'The primary goal of UX (User Experience) design is to make products usable, useful, and enjoyable for the people who use them.',
                        difficulty: 'easy',
                        category: 'UX Fundamentals'
                    },
                    {
                        text: 'What is the difference between UI and UX?',
                        options: [
                            'UI focuses on the look and feel, while UX focuses on the overall experience',
                            'UI focuses on the overall experience, while UX focuses on the look and feel',
                            'They are the same thing',
                            'UI is for mobile apps, while UX is for websites'
                        ],
                        correctAnswer: 0,
                        explanation: 'UI (User Interface) focuses on the look and feel of a product, while UX (User Experience) focuses on the overall experience a user has with a product.',
                        difficulty: 'easy',
                        category: 'UI/UX Basics'
                    },
                    {
                        text: 'What is a user persona?',
                        options: [
                            'A fictional character representing a user type',
                            'A real user of a product',
                            'A design pattern',
                            'A testing method'
                        ],
                        correctAnswer: 0,
                        explanation: 'A user persona is a fictional character created to represent a user type that might use a site, brand, or product in a similar way.',
                        difficulty: 'medium',
                        category: 'User Research'
                    },
                    {
                        text: 'What is the purpose of wireframing in the design process?',
                        options: [
                            'To create a basic structure of a design before adding visual details',
                            'To create the final visual design',
                            'To test the usability of a design',
                            'To conduct user research'
                        ],
                        correctAnswer: 0,
                        explanation: 'Wireframing is an early step in the design process where basic structures and layouts are created before adding visual details.',
                        difficulty: 'easy',
                        category: 'Design Process'
                    },
                    {
                        text: 'What is the difference between usability and accessibility?',
                        options: [
                            'Usability focuses on ease of use, while accessibility focuses on making products usable by people with disabilities',
                            'Usability focuses on making products usable by people with disabilities, while accessibility focuses on ease of use',
                            'They are the same thing',
                            'Usability is for mobile, while accessibility is for desktop'
                        ],
                        correctAnswer: 0,
                        explanation: 'Usability focuses on how easy and intuitive a product is to use, while accessibility focuses on making products usable by people with disabilities.',
                        difficulty: 'medium',
                        category: 'Design Principles'
                    },
                    {
                        text: 'What is a user journey map?',
                        options: [
                            'A visualization of the process a person goes through to accomplish a goal',
                            'A map of a physical space',
                            'A list of user requirements',
                            'A testing methodology'
                        ],
                        correctAnswer: 0,
                        explanation: 'A user journey map is a visualization of the process that a person goes through in order to accomplish a goal with a product or service.',
                        difficulty: 'medium',
                        category: 'User Research'
                    },
                    {
                        text: 'What is the purpose of A/B testing in UX design?',
                        options: [
                            'To compare two versions of a design to see which performs better',
                            'To test the accessibility of a design',
                            'To create wireframes',
                            'To conduct user interviews'
                        ],
                        correctAnswer: 0,
                        explanation: 'A/B testing is a method of comparing two versions of a webpage or app against each other to determine which one performs better.',
                        difficulty: 'medium',
                        category: 'Testing'
                    },
                    {
                        text: 'What is the difference between formative and summative usability testing?',
                        options: [
                            'Formative testing is conducted during design to identify issues, while summative testing is conducted at the end to measure usability',
                            'Formative testing is conducted at the end, while summative testing is conducted during design',
                            'They are the same thing',
                            'Formative testing is qualitative, while summative testing is quantitative'
                        ],
                        correctAnswer: 0,
                        explanation: 'Formative usability testing is conducted during the design process to identify and fix issues, while summative testing is conducted at the end to measure the overall usability.',
                        difficulty: 'advanced',
                        category: 'Testing'
                    },
                    {
                        text: 'What is the purpose of information architecture in UX design?',
                        options: [
                            'To organize and structure content in a clear and intuitive way',
                            'To create visual designs',
                            'To conduct user research',
                            'To test usability'
                        ],
                        correctAnswer: 0,
                        explanation: 'Information architecture is the practice of organizing and structuring content in a clear and intuitive way to help users find information and complete tasks.',
                        difficulty: 'medium',
                        category: 'Information Architecture'
                    },
                    {
                        text: 'What is the difference between qualitative and quantitative user research?',
                        options: [
                            'Qualitative research focuses on understanding user behavior and motivations, while quantitative research focuses on numerical data and statistics',
                            'Qualitative research focuses on numerical data, while quantitative research focuses on understanding behavior',
                            'They are the same thing',
                            'Qualitative research is for websites, while quantitative research is for mobile apps'
                        ],
                        correctAnswer: 0,
                        explanation: 'Qualitative research focuses on understanding user behavior, motivations, and attitudes through methods like interviews and observations, while quantitative research focuses on numerical data and statistics through methods like surveys and analytics.',
                        difficulty: 'medium',
                        category: 'User Research'
                    },
                    {
                        text: 'What is the purpose of a design system?',
                        options: [
                            'To provide a collection of reusable components and standards to ensure consistency',
                            'To create individual designs',
                            'To conduct user research',
                            'To test usability'
                        ],
                        correctAnswer: 0,
                        explanation: 'A design system is a collection of reusable components, guided by clear standards, that can be assembled together to build any number of applications.',
                        difficulty: 'medium',
                        category: 'Design Systems'
                    },
                    {
                        text: 'What is the difference between a mockup and a prototype?',
                        options: [
                            'A mockup is a static visual representation, while a prototype is an interactive model',
                            'A mockup is interactive, while a prototype is static',
                            'They are the same thing',
                            'A mockup is for websites, while a prototype is for mobile apps'
                        ],
                        correctAnswer: 0,
                        explanation: 'A mockup is a static, high-fidelity visual representation of a design, while a prototype is an interactive model that simulates user interaction.',
                        difficulty: 'easy',
                        category: 'Design Process'
                    }
                ]
            },
            'project-mgmt': {
                title: 'Project Management',
                description: 'Assess your understanding of agile methodologies and project planning',
                timeLimit: 15, // Reduced from 30 to 15 minutes
                questions: [
                    {
                        text: 'What is the primary goal of project management?',
                        options: [
                            'To achieve specific project goals within given constraints',
                            'To create detailed documentation',
                            'To manage team members',
                            'To allocate resources'
                        ],
                        correctAnswer: 0,
                        explanation: 'The primary goal of project management is to achieve specific project goals within given constraints such as time, cost, and scope.',
                        difficulty: 'easy',
                        category: 'Project Management Basics'
                    },
                    {
                        text: 'What is the difference between a project and a program?',
                        options: [
                            'A project is temporary with a defined end, while a program is a group of related projects managed together',
                            'A project is permanent, while a program is temporary',
                            'They are the same thing',
                            'A project is for small teams, while a program is for large teams'
                        ],
                        correctAnswer: 0,
                        explanation: 'A project is a temporary endeavor with a defined beginning and end, while a program is a group of related projects managed together to achieve benefits not available from managing them individually.',
                        difficulty: 'medium',
                        category: 'Project Management Basics'
                    },
                    {
                        text: 'What is the purpose of a project charter?',
                        options: [
                            'To formally authorize a project and provide the project manager with authority',
                            'To create a detailed project plan',
                            'To manage project risks',
                            'To communicate with stakeholders'
                        ],
                        correctAnswer: 0,
                        explanation: 'A project charter is a formal document that authorizes the existence of a project and provides the project manager with the authority to apply organizational resources to project activities.',
                        difficulty: 'medium',
                        category: 'Project Initiation'
                    },
                    {
                        text: 'What is the difference between agile and waterfall project management?',
                        options: [
                            'Agile is iterative and flexible, while waterfall is sequential and linear',
                            'Agile is sequential and linear, while waterfall is iterative and flexible',
                            'They are the same thing',
                            'Agile is for software, while waterfall is for construction'
                        ],
                        correctAnswer: 0,
                        explanation: 'Agile project management is iterative and flexible, allowing for changes throughout the project, while waterfall is sequential and linear, with each phase completed before the next begins.',
                        difficulty: 'easy',
                        category: 'Project Management Methodologies'
                    },
                    {
                        text: 'What is a sprint in agile project management?',
                        options: [
                            'A fixed time period during which specific work is completed and made ready for review',
                            'A type of meeting',
                            'A document that outlines project requirements',
                            'A risk management technique'
                        ],
                        correctAnswer: 0,
                        explanation: 'A sprint is a fixed time period (usually 1-4 weeks) during which a specific set of work is completed and made ready for review.',
                        difficulty: 'easy',
                        category: 'Agile'
                    },
                    {
                        text: 'What is the purpose of a work breakdown structure (WBS)?',
                        options: [
                            'To break down a project into smaller, more manageable components',
                            'To create a project schedule',
                            'To manage project risks',
                            'To allocate resources'
                        ],
                        correctAnswer: 0,
                        explanation: 'A work breakdown structure (WBS) is a hierarchical decomposition of the total scope of work to be carried out by the project team.',
                        difficulty: 'medium',
                        category: 'Project Planning'
                    },
                    {
                        text: 'What is the difference between a milestone and a deliverable?',
                        options: [
                            'A milestone is a significant point in a project schedule, while a deliverable is a tangible output',
                            'A milestone is a tangible output, while a deliverable is a significant point in a project schedule',
                            'They are the same thing',
                            'A milestone is for planning, while a deliverable is for execution'
                        ],
                        correctAnswer: 0,
                        explanation: 'A milestone is a significant event or point in a project schedule, while a deliverable is any unique and verifiable product, result, or capability to perform a service that is required to be produced to complete a project.',
                        difficulty: 'medium',
                        category: 'Project Planning'
                    },
                    {
                        text: 'What is the purpose of a risk register in project management?',
                        options: [
                            'To identify, analyze, and track potential project risks',
                            'To create a project schedule',
                            'To allocate resources',
                            'To communicate with stakeholders'
                        ],
                        correctAnswer: 0,
                        explanation: 'A risk register is a tool used in project management to identify, analyze, and track potential risks that could affect the project.',
                        difficulty: 'medium',
                        category: 'Risk Management'
                    },
                    {
                        text: 'What is the difference between a Gantt chart and a PERT chart?',
                        options: [
                            'A Gantt chart shows project timeline visually, while a PERT chart shows task dependencies',
                            'A Gantt chart shows task dependencies, while a PERT chart shows project timeline visually',
                            'They are the same thing',
                            'A Gantt chart is for small projects, while a PERT chart is for large projects'
                        ],
                        correctAnswer: 0,
                        explanation: 'A Gantt chart is a bar chart that shows a project schedule visually, while a PERT (Program Evaluation and Review Technique) chart is a flowchart that shows task dependencies.',
                        difficulty: 'medium',
                        category: 'Project Scheduling'
                    },
                    {
                        text: 'What is the purpose of a stakeholder register?',
                        options: [
                            'To identify and document information about project stakeholders',
                            'To create a project schedule',
                            'To manage project risks',
                            'To allocate resources'
                        ],
                        correctAnswer: 0,
                        explanation: 'A stakeholder register is a document that identifies all project stakeholders and records information about their interests, involvement, and impact on the project.',
                        difficulty: 'medium',
                        category: 'Stakeholder Management'
                    }
                ]
            },
            'javascript-advanced': {
                title: 'JavaScript Advanced',
                description: 'Test your knowledge of advanced JavaScript concepts and patterns',
                timeLimit: 15,
                questions: [
                    {
                        text: 'What is the difference between `call`, `apply`, and `bind` in JavaScript?',
                        options: [
                            '`call` and `apply` are similar but `apply` takes arguments as an array, `bind` returns a new function',
                            '`call` and `apply` are the same, `bind` is different',
                            'There is no difference'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `call` and `apply` methods are similar in that they both call a function with a specified `this` value and arguments. The difference is that `call` takes arguments individually, while `apply` takes them as an array. `bind` returns a new function with the `this` value set and optionally some initial arguments.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is a closure in JavaScript?',
                        options: [
                            'A function that has access to its outer function scope even after the outer function has returned',
                            'A function that is called immediately after it is defined',
                            'A function that is used as a constructor',
                            'A function that returns another function'
                        ],
                        correctAnswer: 0,
                        explanation: 'A closure is a function that has access to its outer function scope even after the outer function has returned. This allows for data encapsulation and the creation of private variables.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is event delegation in JavaScript?',
                        options: [
                            'A pattern where a single event listener is attached to a parent element to handle events for multiple child elements',
                            'A way to prevent events from bubbling up the DOM tree',
                            'A method to create custom events',
                            'A technique to optimize event handling'
                        ],
                        correctAnswer: 0,
                        explanation: 'Event delegation is a pattern where a single event listener is attached to a parent element to handle events for multiple child elements. This is more efficient than attaching separate listeners to each child element.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is the purpose of the `async/await` syntax in JavaScript?',
                        options: [
                            'To make asynchronous code look and behave more like synchronous code',
                            'To create synchronous functions',
                            'To handle errors in asynchronous code',
                            'To optimize performance of asynchronous operations'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `async/await` syntax is built on top of Promises and allows you to write asynchronous code that looks and behaves like synchronous code, making it easier to read and understand.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is a promise in JavaScript?',
                        options: [
                            'An object representing the eventual completion or failure of an asynchronous operation',
                            'A function that returns a value',
                            'A method to handle errors',
                            'A way to create synchronous code'
                        ],
                        correctAnswer: 0,
                        explanation: 'A Promise is an object representing the eventual completion or failure of an asynchronous operation. It has three states: pending, fulfilled, and rejected.',
                        difficulty: 'easy',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is the difference between `==` and `===` in JavaScript?',
                        options: [
                            '`==` performs type coercion, while `===` does not',
                            '`===` performs type coercion, while `==` does not',
                            'They are the same',
                            '`==` is for comparison, `===` is for assignment'
                        ],
                        correctAnswer: 0,
                        explanation: '`==` performs type coercion before comparison, meaning it converts the operands to the same type before comparing. `===` does not perform type coercion and requires both value and type to be the same.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is the `this` keyword in JavaScript?',
                        options: [
                            'A reference to the current execution context',
                            'A reference to the global object',
                            'A reference to the function itself',
                            'A reference to the parent object'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `this` keyword refers to the current execution context, which depends on how a function is called. It can be the global object, the object that owns the method, or undefined in strict mode.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is hoisting in JavaScript?',
                        options: [
                            'The behavior of moving declarations to the top of their scope during compilation',
                            'The process of lifting functions to a higher scope',
                            'A way to optimize JavaScript code',
                            'A method to access variables from outer scopes'
                        ],
                        correctAnswer: 0,
                        explanation: 'Hoisting is a JavaScript behavior where variable and function declarations are moved to the top of their containing scope during the compilation phase, before the code is executed.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is the difference between `let`, `const`, and `var` in JavaScript?',
                        options: [
                            '`var` is function-scoped, while `let` and `const` are block-scoped',
                            '`let` is function-scoped, while `var` and `const` are block-scoped',
                            '`const` is function-scoped, while `var` and `let` are block-scoped',
                            'They are all the same'
                        ],
                        correctAnswer: 0,
                        explanation: '`var` is function-scoped, meaning it is accessible throughout the function in which it is declared. `let` and `const` are block-scoped, meaning they are only accessible within the block (enclosed by curly braces) in which they are declared. Additionally, `const` variables cannot be reassigned.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    },
                    {
                        text: 'What is a higher-order function in JavaScript?',
                        options: [
                            'A function that takes other functions as arguments or returns a function',
                            'A function that is called with a higher precedence',
                            'A function that is defined inside another function',
                            'A function that has access to the global scope'
                        ],
                        correctAnswer: 0,
                        explanation: 'A higher-order function is a function that takes other functions as arguments (callbacks) or returns a function as its result. Examples include `map`, `filter`, and `reduce`.',
                        difficulty: 'medium',
                        category: 'JavaScript Advanced'
                    }
                ]
            },
            'css-mastery': {
                title: 'CSS Mastery',
                description: 'Test your knowledge of advanced CSS techniques and layout methods',
                timeLimit: 15,
                questions: [
                    {
                        text: 'What is the difference between `display: none` and `visibility: hidden`?',
                        options: [
                            '`display: none` removes the element from the layout, `visibility: hidden` keeps it but makes it invisible',
                            '`visibility: hidden` removes the element from the layout, `display: none` keeps it but makes it invisible',
                            'They are the same',
                            'None of the above'
                        ],
                        correctAnswer: 0,
                        explanation: '`display: none` removes the element from the layout, so it does not take up space. `visibility: hidden` makes the element invisible but it still takes up space in the layout.',
                        difficulty: 'easy',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the CSS box model?',
                        options: [
                            'A model that describes how elements are rendered, including content, padding, border, and margin',
                            'A model for organizing CSS files',
                            'A model for CSS animations',
                            'A model for CSS selectors'
                        ],
                        correctAnswer: 0,
                        explanation: 'The CSS box model is a fundamental concept that describes how elements are rendered on a web page. It consists of content, padding, borders and margins.',
                        difficulty: 'easy',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the purpose of CSS Flexbox?',
                        options: [
                            'To create flexible layouts that can adapt to different screen sizes',
                            'To create fixed-width layouts',
                            'To style text elements',
                            'To add animations to elements'
                        ],
                        correctAnswer: 0,
                        explanation: 'CSS Flexbox is a layout model that allows you to create flexible, responsive layouts. It provides an efficient way to align and distribute space among items in a container, even when their size is unknown or dynamic.',
                        difficulty: 'medium',
                        category: 'CSS'
                    },
                    {
                        text: 'What is CSS Grid?',
                        options: [
                            'A two-dimensional layout system for the web',
                            'A one-dimensional layout system',
                            'A way to style text in a grid pattern',
                            'A method for creating grid backgrounds'
                        ],
                        correctAnswer: 0,
                        explanation: 'CSS Grid is a two-dimensional layout system that allows you to create complex layouts with rows and columns. It provides more control over the positioning and alignment of elements than Flexbox.',
                        difficulty: 'medium',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the difference between `em` and `rem` units in CSS?',
                        options: [
                            '`em` is relative to the parent element\'s font size, while `rem` is relative to the root element\'s font size',
                            '`rem` is relative to the parent element\'s font size, while `em` is relative to the root element\'s font size',
                            'They are the same',
                            '`em` is for width, `rem` is for height'
                        ],
                        correctAnswer: 0,
                        explanation: '`em` units are relative to the font size of the parent element, while `rem` units are relative to the font size of the root element (usually the `<html>` element). This makes `rem` more predictable for creating consistent spacing across a website.',
                        difficulty: 'medium',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the purpose of CSS preprocessors like Sass or Less?',
                        options: [
                            'To extend CSS with variables, nesting, mixins, and other features',
                            'To make CSS load faster',
                            'To reduce the size of CSS files',
                            'To add animations to CSS'
                        ],
                        correctAnswer: 0,
                        explanation: 'CSS preprocessors like Sass and Less extend CSS with programming features like variables, nesting, mixins, functions, and more. They help write more maintainable and organized CSS code.',
                        difficulty: 'medium',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the `z-index` property in CSS used for?',
                        options: [
                            'To control the stacking order of positioned elements',
                            'To set the zoom level of an element',
                            'To define the position of an element',
                            'To add a shadow to an element'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `z-index` property specifies the stack order of an element. An element with a higher `z-index` will be in front of an element with a lower `z-index`. This only works on positioned elements (position: absolute, relative, fixed, or sticky).',
                        difficulty: 'medium',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the purpose of CSS media queries?',
                        options: [
                            'To apply different styles based on the characteristics of the device',
                            'To query a database for CSS styles',
                            'To add media to a webpage',
                            'To optimize CSS for search engines'
                        ],
                        correctAnswer: 0,
                        explanation: 'CSS media queries allow you to apply different styles based on the characteristics of the device, such as its width, height, or orientation. They are essential for creating responsive designs that work well on different devices.',
                        difficulty: 'easy',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the difference between `position: relative` and `position: absolute` in CSS?',
                        options: [
                            '`relative` positions an element relative to its normal position, while `absolute` positions it relative to its nearest positioned ancestor',
                            '`absolute` positions an element relative to its normal position, while `relative` positions it relative to its nearest positioned ancestor',
                            'They are the same',
                            '`relative` is for horizontal positioning, `absolute` is for vertical positioning'
                        ],
                        correctAnswer: 0,
                        explanation: '`position: relative` positions an element relative to its normal position in the document flow. `position: absolute` takes the element out of the normal document flow and positions it relative to its nearest positioned ancestor (an ancestor with any position other than static).',
                        difficulty: 'medium',
                        category: 'CSS'
                    },
                    {
                        text: 'What is the CSS `:not()` pseudo-class used for?',
                        options: [
                            'To select elements that do not match a certain selector',
                            'To select elements that match a certain selector',
                            'To negate a CSS property',
                            'To create a negative margin'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `:not()` pseudo-class takes a selector as an argument and selects elements that do not match that selector. For example, `:not(.active)` selects all elements that do not have the class "active".',
                        difficulty: 'medium',
                        category: 'CSS'
                    }
                ]
            },
            'python-basics': {
                title: 'Python Basics',
                description: 'Test your knowledge of Python fundamentals and programming concepts',
                timeLimit: 15,
                questions: [
                    {
                        text: 'Which of the following is the correct way to create a list in Python?',
                        options: [
                            'my_list = [1, 2, 3]',
                            'my_list = (1, 2, 3)',
                            'my_list = {1, 2, 3}',
                            'my_list = "1, 2, 3"'
                        ],
                        correctAnswer: 0,
                        explanation: 'In Python, lists are created using square brackets []. Tuples use parentheses (), sets use curly braces {}, and strings use quotes.',
                        difficulty: 'easy',
                        category: 'Python Basics'
                    },
                    {
                        text: 'What is the output of `print(2 ** 3)` in Python?',
                        options: [
                            '8',
                            '6',
                            '9',
                            'Error'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `**` operator in Python is used for exponentiation. So `2 ** 3` means 2 raised to the power of 3, which is 8.',
                        difficulty: 'easy',
                        category: 'Python Basics'
                    },
                    {
                        text: 'Which of the following is used to create a function in Python?',
                        options: [
                            'def',
                            'function',
                            'func',
                            'define'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `def` keyword is used to define a function in Python. For example: `def myFunction():`.',
                        difficulty: 'easy',
                        category: 'Python Basics'
                    },
                    {
                        text: 'What is the correct way to comment multiple lines in Python?',
                        options: [
                            'Using triple quotes: """Comment"""',
                            'Using // at the beginning of each line',
                            'Using /* at the beginning and */ at the end',
                            'Using # at the beginning of each line'
                        ],
                        correctAnswer: 0,
                        explanation: 'In Python, you can create multi-line comments using triple quotes (""" or """). Single-line comments use the # symbol.',
                        difficulty: 'easy',
                        category: 'Python Basics'
                    },
                    {
                        text: 'What is the output of `print(type([]))` in Python?',
                        options: [
                            '<class \'list\'>',
                            '<class \'array\'>',
                            '<class \'tuple\'>',
                            'Error'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `[]` creates an empty list in Python. The `type()` function returns the type of the object, which is `<class \'list\'>`.',
                        difficulty: 'easy',
                        category: 'Python Basics'
                    },
                    {
                        text: 'Which of the following is the correct way to create a dictionary in Python?',
                        options: [
                            'my_dict = {"key": "value"}',
                            'my_dict = ["key": "value"]',
                            'my_dict = ("key": "value")',
                            'my_dict = {"key", "value"}'
                        ],
                        correctAnswer: 0,
                        explanation: 'In Python, dictionaries are created using curly braces {} with key-value pairs separated by colons.',
                        difficulty: 'easy',
                        category: 'Python Basics'
                    },
                    {
                        text: 'What is the correct way to check if a key exists in a dictionary in Python?',
                        options: [
                            'if "key" in my_dict:',
                            'if my_dict.has_key("key"):',
                            'if my_dict.exists("key"):',
                            'if my_dict.contains("key"):'
                        ],
                        correctAnswer: 0,
                        explanation: 'In Python, you can check if a key exists in a dictionary using the `in` keyword: `if "key" in my_dict:`.',
                        difficulty: 'medium',
                        category: 'Python Basics'
                    },
                    {
                        text: 'What is the output of `print(10 // 3)` in Python?',
                        options: [
                            '3',
                            '3.3333333333333335',
                            '1',
                            'Error'
                        ],
                        correctAnswer: 0,
                        explanation: 'The `//` operator in Python is used for floor division, which returns the largest integer less than or equal to the division result. So `10 // 3` is 3.',
                        difficulty: 'medium',
                        category: 'Python Basics'
                    },
                    {
                        text: 'Which of the following is used to handle exceptions in Python?',
                        options: [
                            'try-except',
                            'catch-throw',
                            'do-while',
                            'if-else'
                        ],
                        correctAnswer: 0,
                        explanation: 'In Python, exceptions are handled using `try-except` blocks. Code that might raise an exception is placed in the `try` block, and code to handle the exception is placed in the `except` block.',
                        difficulty: 'medium',
                        category: 'Python Basics'
                    },
                    {
                        text: 'What is the correct way to create a class in Python?',
                        options: [
                            'class MyClass:',
                            'def MyClass():',
                            'create class MyClass:',
                            'MyClass = class():'
                        ],
                        correctAnswer: 0,
                        explanation: 'In Python, classes are created using the `class` keyword followed by the class name and a colon: `class MyClass:`.',
                        difficulty: 'easy',
                        category: 'Python Basics'
                    }
                ]
            },
            'machine-learning': {
                title: 'Machine Learning',
                description: 'Assess your understanding of ML algorithms and concepts',
                timeLimit: 20,
                questions: [
                    {
                        text: 'What is the difference between supervised and unsupervised learning?',
                        options: [
                            'Supervised learning uses labeled data, while unsupervised learning uses unlabeled data',
                            'Supervised learning uses unlabeled data, while unsupervised learning uses labeled data',
                            'They are the same thing',
                            'Supervised learning is for classification, while unsupervised learning is for regression'
                        ],
                        correctAnswer: 0,
                        explanation: 'Supervised learning uses labeled data (data with known outcomes) to train models, while unsupervised learning finds patterns in data without labeled outcomes.',
                        difficulty: 'easy',
                        category: 'Machine Learning Basics'
                    },
                    {
                        text: 'What is overfitting in machine learning?',
                        options: [
                            'When a model learns the training data too well and fails to generalize to new data',
                            'When a model is too simple to capture the underlying patterns',
                            'When a model has too many features',
                            'When a model takes too long to train'
                        ],
                        correctAnswer: 0,
                        explanation: 'Overfitting occurs when a machine learning model learns the training data too well, including noise and outliers, and fails to generalize to new, unseen data.',
                        difficulty: 'medium',
                        category: 'Machine Learning Concepts'
                    },
                    {
                        text: 'What is the purpose of cross-validation in machine learning?',
                        options: [
                            'To evaluate how well a model will generalize to an independent dataset',
                            'To increase the size of the training data',
                            'To reduce the number of features in a model',
                            'To speed up the training process'
                        ],
                        correctAnswer: 0,
                        explanation: 'Cross-validation is a technique used to evaluate how well a machine learning model will generalize to an independent dataset. It involves partitioning the data into subsets, training the model on one subset, and validating it on another.',
                        difficulty: 'medium',
                        category: 'Machine Learning Evaluation'
                    },
                    {
                        text: 'Which of the following is a common algorithm for classification tasks?',
                        options: [
                            'Random Forest',
                            'Linear Regression',
                            'K-Means Clustering',
                            'Principal Component Analysis'
                        ],
                        correctAnswer: 0,
                        explanation: 'Random Forest is a popular algorithm for classification tasks. It builds multiple decision trees and merges them to get a more accurate and stable prediction.',
                        difficulty: 'medium',
                        category: 'Machine Learning Algorithms'
                    },
                    {
                        text: 'What is the difference between precision and recall?',
                        options: [
                            'Precision is the ratio of correctly predicted positive observations to total predicted positives, while recall is the ratio of correctly predicted positive observations to all actual positives',
                            'Precision is the ratio of correctly predicted negative observations to total predicted negatives, while recall is the ratio of correctly predicted positive observations to all actual positives',
                            'They are the same thing',
                            'Precision is for regression, while recall is for classification'
                        ],
                        correctAnswer: 0,
                        explanation: 'Precision is the ratio of correctly predicted positive observations to the total predicted positives, while recall is the ratio of correctly predicted positive observations to all actual positives in the data.',
                        difficulty: 'medium',
                        category: 'Machine Learning Evaluation'
                    },
                    {
                        text: 'What is the purpose of regularization in machine learning?',
                        options: [
                            'To prevent overfitting by adding a penalty term to the loss function',
                            'To increase the complexity of a model',
                            'To reduce the size of the training data',
                            'To speed up the training process'
                        ],
                        correctAnswer: 0,
                        explanation: 'Regularization is a technique used to prevent overfitting by adding a penalty term to the loss function. This discourages complex models that fit the training data too closely.',
                        difficulty: 'medium',
                        category: 'Machine Learning Concepts'
                    },
                    {
                        text: 'Which of the following is an example of unsupervised learning?',
                        options: [
                            'K-Means Clustering',
                            'Linear Regression',
                            'Logistic Regression',
                            'Support Vector Machines'
                        ],
                        correctAnswer: 0,
                        explanation: 'K-Means Clustering is an example of unsupervised learning because it groups data points into clusters without using labeled data. The other options are supervised learning algorithms.',
                        difficulty: 'easy',
                        category: 'Machine Learning Algorithms'
                    },
                    {
                        text: 'What is the purpose of feature scaling in machine learning?',
                        options: [
                            'To normalize the range of independent variables or features of data',
                            'To increase the number of features',
                            'To reduce the number of features',
                            'To convert categorical data to numerical data'
                        ],
                        correctAnswer: 0,
                        explanation: 'Feature scaling is a technique used to normalize the range of independent variables or features of data. It is important for algorithms that are sensitive to the magnitude of features, such as gradient descent-based algorithms and distance-based algorithms.',
                        difficulty: 'medium',
                        category: 'Machine Learning Preprocessing'
                    },
                    {
                        text: 'What is a box plot used for?',
                        options: [
                            'To display the distribution of data based on a five-number summary',
                            'To show trends over time',
                            'To compare parts of a whole',
                            'To show correlation between two variables'
                        ],
                        correctAnswer: 0,
                        explanation: 'A box plot is a standardized way of displaying the distribution of data based on a five-number summary: minimum, first quartile, median, third quartile, and maximum.',
                        difficulty: 'medium',
                        category: 'Machine Learning Visualization'
                    },
                    {
                        text: 'What is the difference between a parametric and a non-parametric model in machine learning?',
                        options: [
                            'Parametric models make assumptions about the underlying data distribution, while non-parametric models do not',
                            'Parametric models do not make assumptions about the underlying data distribution, while non-parametric models do',
                            'They are the same thing',
                            'Parametric models are for classification, while non-parametric models are for regression'
                        ],
                        correctAnswer: 0,
                        explanation: 'Parametric models make assumptions about the underlying data distribution (e.g., linear regression assumes a linear relationship). Non-parametric models do not make such assumptions and can fit more complex patterns.',
                        difficulty: 'advanced',
                        category: 'Machine Learning Concepts'
                    },
                    {
                        text: 'What is the purpose of the confusion matrix in machine learning?',
                        options: [
                            'To evaluate the performance of a classification model',
                            'To visualize the distribution of data',
                            'To reduce the dimensionality of data',
                            'To handle missing values in data'
                        ],
                        correctAnswer: 0,
                        explanation: 'A confusion matrix is a table used to evaluate the performance of a classification model. It shows the number of correct and incorrect predictions for each class, allowing for the calculation of metrics like accuracy, precision, recall, and F1 score.',
                        difficulty: 'medium',
                        category: 'Machine Learning Evaluation'
                    }
                ]
            },
            'peer-review': {
                title: 'Portfolio Review',
                description: 'Get feedback from peers on your portfolio projects and presentation',
                timeLimit: 0, // No time limit for peer review
                questions: [
                    {
                        text: 'How would you rate the overall visual design of this portfolio?',
                        options: [
                            'Excellent',
                            'Good',
                            'Average',
                            'Below Average',
                            'Poor'
                        ],
                        correctAnswer: null, // No correct answer for peer review
                        explanation: 'This is a subjective rating based on personal preference and design principles.',
                        difficulty: 'easy',
                        category: 'Visual Design'
                    },
                    {
                        text: 'How clear and easy to navigate is the portfolio structure?',
                        options: [
                            'Very Clear',
                            'Clear',
                            'Somewhat Clear',
                            'Unclear',
                            'Very Unclear'
                        ],
                        correctAnswer: null,
                        explanation: 'This evaluates the information architecture and user experience of the portfolio.',
                        difficulty: 'easy',
                        category: 'Navigation'
                    },
                    {
                        text: 'How well does the portfolio showcase the person\'s skills and experience?',
                        options: [
                            'Very Well',
                            'Well',
                            'Adequately',
                            'Poorly',
                            'Very Poorly'
                        ],
                        correctAnswer: null,
                        explanation: 'This assesses how effectively the portfolio demonstrates the person\'s capabilities.',
                        difficulty: 'easy',
                        category: 'Content Quality'
                    },
                    {
                        text: 'How engaging and compelling is the project presentation?',
                        options: [
                            'Very Engaging',
                            'Engaging',
                            'Neutral',
                            'Unengaging',
                            'Very Unengaging'
                        ],
                        correctAnswer: null,
                        explanation: 'This evaluates the storytelling and presentation skills demonstrated in the portfolio.',
                        difficulty: 'easy',
                        category: 'Presentation'
                    },
                    {
                        text: 'What aspects of this portfolio do you find most impressive?',
                        options: [
                            'Visual Design',
                            'Project Quality',
                            'Writing/Communication',
                            'Technical Skills',
                            'Creativity/Innovation'
                        ],
                        correctAnswer: null,
                        explanation: 'This helps identify the strengths of the portfolio.',
                        difficulty: 'easy',
                        category: 'Strengths'
                    },
                    {
                        text: 'What areas of this portfolio could be improved?',
                        options: [
                            'Visual Design',
                            'Project Details',
                            'Navigation/Structure',
                            'Technical Information',
                            'Overall Presentation'
                        ],
                        correctAnswer: null,
                        explanation: 'This provides constructive feedback for improvement.',
                        difficulty: 'easy',
                        category: 'Improvements'
                    },
                    {
                        text: 'How would you rate the technical implementation of the portfolio?',
                        options: [
                            'Excellent',
                            'Good',
                            'Average',
                            'Below Average',
                            'Poor'
                        ],
                        correctAnswer: null,
                        explanation: 'This assesses the technical quality of the portfolio implementation.',
                        difficulty: 'medium',
                        category: 'Technical Quality'
                    },
                    {
                        text: 'How well does the portfolio demonstrate problem-solving skills?',
                        options: [
                            'Very Well',
                            'Well',
                            'Adequately',
                            'Poorly',
                            'Very Poorly'
                        ],
                        correctAnswer: null,
                        explanation: 'This evaluates how effectively the portfolio showcases the person\'s ability to solve problems.',
                        difficulty: 'medium',
                        category: 'Problem Solving'
                    },
                    {
                        text: 'How effectively does the portfolio communicate the person\'s unique value proposition?',
                        options: [
                            'Very Effectively',
                            'Effectively',
                            'Adequately',
                            'Ineffectively',
                            'Very Ineffectively'
                        ],
                        correctAnswer: null,
                        explanation: 'This assesses how well the portfolio differentiates the person from others.',
                        difficulty: 'medium',
                        category: 'Value Proposition'
                    },
                    {
                        text: 'Would you recommend this portfolio to others as an example of good work?',
                        options: [
                            'Definitely',
                            'Probably',
                            'Maybe',
                            'Probably Not',
                            'Definitely Not'
                        ],
                        correctAnswer: null,
                        explanation: 'This provides an overall assessment of the portfolio quality.',
                        difficulty: 'easy',
                        category: 'Overall Assessment'
                    }
                ]
            }
        };
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', async () => {
            // Show a notification about the backend status
            if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
                showToast('This demo is using a mock backend. Some features may not work.', 'info');
                
                // Disable AI generation for demo
                generateBtn.addEventListener('click', () => {
                    showToast('AI generation requires a backend server. This is a frontend demo.', 'error');
                });
                
                // Disable save for demo
                saveAndPreviewBtn.addEventListener('click', () => {
                    showToast('Saving requires a backend server. This is a frontend demo.', 'error');
                });
            } else {
                // Fetch server info to get the local IP
                try {
                    const response = await fetch(`${API_URL}/api/server-info`);
                    const serverInfo = await response.json();
                    SHAREABLE_URL = serverInfo.url;
                    console.log(`Shareable URL set to: ${SHAREABLE_URL}`);
                    updateNetworkStatus(true, `Server accessible at ${SHAREABLE_URL}`);
                } catch (error) {
                    console.error('Failed to get server info:', error);
                    // Fallback: try to use the current host with the backend port
                    const currentHost = window.location.hostname;
                    const backendPort = API_URL.split(':')[2] || '3000';
                    SHAREABLE_URL = `http://${currentHost}:${backendPort}`;
                    console.log(`Fallback shareable URL set to: ${SHAREABLE_URL}`);
                    updateNetworkStatus(false, `Using fallback URL: ${SHAREABLE_URL}`);
                }
                
                setupDropZone(photoDropZone, photoInput, document.getElementById('photoLabel'));
                setupDropZone(resumeDropZone, resumeInput, document.getElementById('resumeLabel'));
                generateBtn.addEventListener('click', handleGenerateClick);
            }
            
            // Setup contact form submission
            contactForm.addEventListener('submit', handleContactSubmit);
            
            // Setup theme selection
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedTheme = this.dataset.theme;
                });
            });
            
            // Set default theme
            document.querySelector('[data-theme="Default"]').classList.add('selected');
            
            // Setup editor photo upload
            const editorPhotoDropZone = document.querySelector('#editorView .drop-zone');
            const editorPhotoInput = document.getElementById('editorPhotoInput');
            setupDropZone(editorPhotoDropZone, editorPhotoInput);
            editorPhotoInput.addEventListener('change', handleEditorPhotoChange);
            
            // Create floating particles
            createParticles();
            
            // Test network connectivity
            testNetworkConnectivity();
            
            // Initialize student database
            initializeStudentDatabase();
            
            // Check if user is logged in
            checkUserLogin();
        });
        
        // --- USER PROFILE MANAGEMENT ---
        function openUserProfileModal() {
            userProfileModal.classList.remove('hidden');
            
            // If user exists, pre-fill the form
            if (currentUser) {
                document.getElementById('userName').value = currentUser.name || '';
                document.getElementById('userEmail').value = currentUser.email || '';
                document.getElementById('userRole').value = currentUser.role || '';
                document.getElementById('userSkills').value = currentUser.skills ? currentUser.skills.join(', ') : '';
            }
        }
        
        function closeUserProfileModal() {
            userProfileModal.classList.add('hidden');
        }
        
        function saveUserProfile() {
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;
            const role = document.getElementById('userRole').value;
            const skills = document.getElementById('userSkills').value.split(',').map(s => s.trim()).filter(Boolean);
            
            if (!name || !email) {
                showToast('Please fill in all required fields', 'error');
                return;
            }
            
            // Create or update user
            if (!currentUser) {
                currentUser = {
                    id: generateUserId(),
                    joinDate: new Date(),
                    progress: {
                        completedAssessments: 0,
                        totalScore: 0,
                        averageScore: 0,
                        skills: {},
                        learningStreak: 0,
                        lastActivityDate: new Date()
                    }
                };
            }
            
            // Update user data
            currentUser.name = name;
            currentUser.email = email;
            currentUser.role = role;
            currentUser.skills = skills;
            
            // Save to database
            const userIndex = studentDatabase.students.findIndex(s => s.id === currentUser.id);
            if (userIndex === -1) {
                studentDatabase.students.push(currentUser);
            } else {
                studentDatabase.students[userIndex] = currentUser;
            }
            
            // Save to localStorage
            localStorage.setItem('portfolioforge_student_db', JSON.stringify(studentDatabase));
            
            // Update UI
            updateUserInfo();
            
            // Close modal
            closeUserProfileModal();
            
            showToast('Profile saved successfully!', 'success');
        }
        
        function generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9);
        }
        
        function checkUserLogin() {
            // Try to get user from localStorage
            const savedUserId = localStorage.getItem('portfolioforge_current_user_id');
            
            if (savedUserId) {
                // Find user in database
                currentUser = studentDatabase.students.find(s => s.id === savedUserId);
                
                if (currentUser) {
                    updateUserInfo();
                    updateDashboard();
                } else {
                    // User not found, clear localStorage
                    localStorage.removeItem('portfolioforge_current_user_id');
                    currentUser = null;
                }
            } else {
                // Check if we have any users in the database
                if (studentDatabase.students.length > 0) {
                    // For demo purposes, use the first user
                    currentUser = studentDatabase.students[0];
                    localStorage.setItem('portfolioforge_current_user_id', currentUser.id);
                    updateUserInfo();
                    updateDashboard();
                }
            }
        }
        
        function updateUserInfo() {
            if (currentUser) {
                headerUserName.textContent = currentUser.name;
                localStorage.setItem('portfolioforge_current_user_id', currentUser.id);
            } else {
                headerUserName.textContent = 'Guest';
            }
        }
        
        function updateDashboard() {
            if (!currentUser || !currentUser.progress) return;
            
            // Update dashboard stats
            completedAssessmentsCount.textContent = currentUser.progress.completedAssessments || 0;
            averageScore.textContent = (currentUser.progress.averageScore || 0) + '%';
            learningStreak.textContent = (currentUser.progress.learningStreak || 0) + ' days';
            
            // Update recent assessments
            updateRecentAssessments();
        }
        
        function updateRecentAssessments() {
            if (!currentUser) return;
            
            // Get user's assessment results
            const userResults = studentDatabase.results.filter(r => r.studentId === currentUser.id);
            
            // Sort by date (newest first)
            userResults.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Take the last 3
            const recentResults = userResults.slice(0, 3);
            
            // Update UI
            recentAssessments.innerHTML = '';
            
            if (recentResults.length === 0) {
                recentAssessments.innerHTML = '<p class="text-gray-400 text-center py-4">No assessments completed yet</p>';
                return;
            }
            
            recentResults.forEach(result => {
                const assessment = studentDatabase.assessments.find(a => a.id === result.assessmentId);
                const date = new Date(result.date);
                const formattedDate = formatDate(date);
                
                const scoreClass = result.score >= 80 ? 'text-green-400' : 
                                   result.score >= 60 ? 'text-yellow-400' : 'text-orange-400';
                
                const scoreText = result.score >= 80 ? 'Excellent' : 
                                  result.score >= 60 ? 'Good' : 'Needs Improvement';
                
                recentAssessments.innerHTML += `
                    <div class="flex items-center justify-between p-4 bg-slate-800/50 rounded-lg">
                        <div>
                            <h4 class="font-bold">${assessment ? assessment.title : 'Unknown Assessment'}</h4>
                            <p class="text-gray-400 text-sm">Completed ${formattedDate}</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="text-right">
                                <p class="font-bold">${result.score}%</p>
                                <p class="${scoreClass} text-sm">${scoreText}</p>
                            </div>
                            <button class="text-indigo-400 hover:text-indigo-300">
                                <i class="fas fa-redo"></i>
                            </button>
                        </div>
                    </div>
                `;
            });
        }
        
        function formatDate(date) {
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) {
                return 'today';
            } else if (diffDays === 1) {
                return 'yesterday';
            } else if (diffDays < 7) {
                return `${diffDays} days ago`;
            } else if (diffDays < 30) {
                return `${Math.floor(diffDays / 7)} weeks ago`;
            } else {
                return date.toLocaleDateString();
            }
        }
        
        // --- NETWORK CONNECTIVITY ---
        function updateNetworkStatus(isConnected, message) {
            statusIndicator.classList.toggle('error', !isConnected);
            statusText.textContent = message;
        }
        
        async function testNetworkConnectivity() {
            // Only test connectivity if we're on localhost
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                try {
                    const response = await fetch(`${API_URL}/health`, { 
                        method: 'GET',
                        timeout: 5000
                    });
                    if (response.ok) {
                        updateNetworkStatus(true, 'Connected to server');
                    } else {
                        updateNetworkStatus(false, 'Server error');
                    }
                } catch (error) {
                    updateNetworkStatus(false, 'Cannot connect to server');
                    console.error('Network connectivity test failed:', error);
                }
            } else {
                updateNetworkStatus(false, 'Backend not available in demo mode');
            }
        }
        
        // --- PARTICLE EFFECT ---
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Random size
                const size = Math.random() * 10 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random position
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Random opacity
                particle.style.opacity = Math.random() * 0.5 + 0.1;
                
                // Random animation duration
                const duration = Math.random() * 50 + 20;
                particle.style.animation = `float ${duration}s infinite ease-in-out`;
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Add CSS for floating animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes float {
                0%, 100% { transform: translateY(0) translateX(0); }
                25% { transform: translateY(-20px) translateX(10px); }
                50% { transform: translateY(10px) translateX(-10px); }
                75% { transform: translateY(-15px) translateX(5px); }
            }
        `;
        document.head.appendChild(style);
        
        // --- VIEW MANAGEMENT ---
        function switchView(viewId) {
            // Hide all views
            Object.values(views).forEach(view => {
                if (view) view.classList.add('hidden');
            });
            
            // Show selected view
            if (views[viewId]) {
                views[viewId].classList.remove('hidden');
                currentView = viewId;
                
                // Generate QR code when portfolio view is shown
                if (viewId === 'portfolioView') {
                    generateQRCode();
                    setupSocialSharing();
                }
                
                // Initialize charts when analytics view is shown
                if (viewId === 'assessmentAnalyticsView') {
                    setTimeout(initializeCharts, 100);
                }
                
                // Update dashboard when dashboard view is shown
                if (viewId === 'assessmentDashboardView') {
                    updateDashboard();
                }
            } else {
                console.error(`View with ID '${viewId}' not found.`);
            }
        }
        
        function handleBackToEditor() {
            // Pre-fill editor with current data before switching
            populateEditor(portfolioData, selectedTheme);
            switchView('editorView');
        }
        
        // --- FILE UPLOAD & DROPZONE LOGIC ---
        function setupDropZone(zone, input, label) {
            const defaultLabel = label ? label.textContent : '';
            zone.addEventListener('click', () => input.click());
            
            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.classList.add('dragover');
            });
            zone.addEventListener('dragleave', () => zone.classList.remove('dragover'));
            
            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('dragover');
                if (e.dataTransfer.files.length) {
                    input.files = e.dataTransfer.files;
                    if (label) updateLabel(input, label, zone, defaultLabel);
                }
            });
            
            if (label) {
                input.addEventListener('change', () => updateLabel(input, label, zone, defaultLabel));
            }
        }
        
        function updateLabel(input, label, zone, defaultLabel) {
             if (input.files.length > 0) {
                label.textContent = `✅ ${input.files[0].name}`;
                zone.classList.add('has-file');
            } else {
                label.textContent = defaultLabel;
                zone.classList.remove('has-file');
            }
        }
        
        function handleEditorPhotoChange() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profilePictureUrl = e.target.result;
                    document.getElementById('profilePhotoPreview').innerHTML = 
                        `<img src="${profilePictureUrl}" alt="Profile" class="w-full h-full object-cover">`;
                };
                reader.readAsDataURL(file);
            }
        }
        
        // --- API & DATA HANDLING ---
        async function handleGenerateClick() {
            if (resumeInput.files.length === 0) {
                showToast('Please upload a resume (PDF) to continue.', 'error');
                return;
            }
            
            aiUploader.classList.add('hidden');
            aiLoading.classList.remove('hidden');
            
            const formData = new FormData();
            formData.append('resume', resumeInput.files[0]);
            if (photoInput.files.length > 0) {
                formData.append('photo', photoInput.files[0]);
            }
            
            try {
                const response = await fetch(`${API_URL}/api/generate-from-resume`, { 
                    method: 'POST', 
                    body: formData 
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to generate portfolio.');
                }
                
                const result = await response.json();
                
                // Store data globally
                portfolioId = result.portfolioId;
                portfolioData = result.portfolioData;
                profilePictureUrl = result.profilePictureUrl;
                selectedTheme = result.theme.name;
                
                // Add portfolio to student database
                addPortfolioToDatabase(portfolioData, selectedTheme, portfolioId);
                
                renderPortfolio(portfolioData, result.theme, profilePictureUrl, portfolioId);
                switchView('portfolioView');
                
                // Update portfolio links
                const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
                portfolioLink.textContent = portfolioUrl;
                directLink.textContent = portfolioUrl;
                
                showToast('Portfolio generated successfully!', 'success');
            } catch (error) {
                console.error(error);
                showToast(error.message, 'error');
                aiUploader.innerHTML = `
                    <div class="text-center text-red-400">
                        <h3>Generation Failed</h3>
                        <p>${error.message}</p>
                        <button class="mt-4 bg-slate-600 px-4 py-2 rounded-lg" onclick="location.reload()">Try Again</button>
                    </div>
                `;
            } finally {
                aiLoading.classList.add('hidden');
                aiUploader.classList.remove('hidden'); 
            }
        }
        
        // --- CONTACT FORM HANDLER ---
        function handleContactSubmit(e) {
            e.preventDefault();
            
            const name = document.getElementById('contactName').value;
            const email = document.getElementById('contactEmail').value;
            const message = document.getElementById('contactMessage').value;
            
            // Here you would normally send the data to a server
            console.log({ name, email, message });
            
            // Show a success message
            showToast('Message sent successfully!', 'success');
            
            // Reset the form
            contactForm.reset();
        }
        
        // --- EDITOR LOGIC ---
        function populateEditor(data, themeName) {
            // Personal info
            document.getElementById('edit-name').value = data.personalInfo?.name || '';
            document.getElementById('edit-email').value = data.personalInfo?.email || '';
            document.getElementById('edit-phone').value = data.personalInfo?.phone || '';
            document.getElementById('edit-website').value = data.personalInfo?.website || '';
            
            // Extract usernames from URLs
            const linkedinUsername = extractUsernameFromUrl(data.personalInfo?.linkedin, 'linkedin');
            const githubUsername = extractUsernameFromUrl(data.personalInfo?.github, 'github');
            
            document.getElementById('edit-linkedin').value = linkedinUsername || '';
            document.getElementById('edit-github').value = githubUsername || '';
            
            // Summary
            document.getElementById('edit-summary').value = data.summary || '';
            
            // Skills
            document.getElementById('edit-skills').value = Array.isArray(data.skills) ? data.skills.join(', ') : '';
            
            // Experience
            const experienceContainer = document.getElementById('experienceContainer');
            experienceContainer.innerHTML = '';
            if (data.experience && data.experience.length > 0) {
                data.experience.forEach((exp, index) => {
                    addExperience(exp, index);
                });
            } else {
                addExperience();
            }
            
            // Projects
            const projectsContainer = document.getElementById('projectsContainer');
            projectsContainer.innerHTML = '';
            if (data.projects && data.projects.length > 0) {
                data.projects.forEach((proj, index) => {
                    addProject(proj, index);
                });
            } else {
                addProject();
            }
            
            // Theme
            document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('selected'));
            const themeOption = document.querySelector(`[data-theme="${themeName}"]`);
            if (themeOption) {
                themeOption.classList.add('selected');
                selectedTheme = themeName;
            }
            
            // Profile photo
            if (profilePictureUrl) {
                document.getElementById('profilePhotoPreview').innerHTML = 
                    `<img src="${profilePictureUrl}" alt="Profile" class="w-full h-full object-cover">`;
            }
        }
        
        function addExperience(data = {}, index = Date.now()) {
            const container = document.getElementById('experienceContainer');
            const expDiv = document.createElement('div');
            expDiv.className = 'glass p-4 rounded-lg';
            expDiv.dataset.index = index;
            
            expDiv.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-bold">Experience ${container.children.length + 1}</h4>
                    <button onclick="removeExperience(${index})" class="text-red-400 hover:text-red-300">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
                <div class="grid md:grid-cols-2 gap-3">
                    <input type="text" placeholder="Company" class="editor-input exp-company" value="${data.company || ''}">
                    <input type="text" placeholder="Role" class="editor-input exp-role" value="${data.role || ''}">
                    <input type="text" placeholder="Dates (e.g., Jan 2020 - Present)" class="editor-input exp-dates" value="${data.dates || ''}">
                    <textarea placeholder="Description (bullet points)" rows="3" class="editor-input exp-description">${data.description ? data.description.join('\n') : ''}</textarea>
                </div>
            `;
            
            container.appendChild(expDiv);
        }
        
        function removeExperience(index) {
            const expDiv = document.querySelector(`[data-index="${index}"]`);
            if (expDiv) {
                expDiv.remove();
            }
        }
        
        function addProject(data = {}, index = Date.now()) {
            const container = document.getElementById('projectsContainer');
            const projDiv = document.createElement('div');
            projDiv.className = 'glass p-4 rounded-lg';
            projDiv.dataset.index = index;
            
            projDiv.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-bold">Project ${container.children.length + 1}</h4>
                    <button onclick="removeProject(${index})" class="text-red-400 hover:text-red-300">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
                <div class="space-y-3">
                    <input type="text" placeholder="Project Title" class="editor-input proj-title" value="${data.title || ''}">
                    <textarea placeholder="Project Description" rows="3" class="editor-input proj-description">${data.description || ''}</textarea>
                    <input type="text" placeholder="Project Link (URL)" class="editor-input proj-link" value="${data.link || ''}">
                </div>
            `;
            
            container.appendChild(projDiv);
        }
        
        function removeProject(index) {
            const projDiv = document.querySelector(`[data-index="${index}"]`);
            if (projDiv) {
                projDiv.remove();
            }
        }
        
        // --- SAVE AND PREVIEW FUNCTION ---
        async function saveAndPreview() {
            // Show loading state
            const originalBtnText = saveAndPreviewBtn.innerHTML;
            saveAndPreviewBtn.innerHTML = '<div class="spinner"></div> Saving...';
            saveAndPreviewBtn.disabled = true;
            
            try {
                // Collect data from the form
                const updatedData = {
                    personalInfo: {
                        name: document.getElementById('edit-name').value,
                        email: document.getElementById('edit-email').value,
                        phone: document.getElementById('edit-phone').value,
                        website: document.getElementById('edit-website').value,
                        linkedin: convertToUrl('linkedin', document.getElementById('edit-linkedin').value),
                        github: convertToUrl('github', document.getElementById('edit-github').value),
                    },
                    summary: document.getElementById('edit-summary').value,
                    skills: document.getElementById('edit-skills').value.split(',').map(s => s.trim()).filter(Boolean),
                    experience: [],
                    projects: [],
                };
                
                // Collect experience data
                document.querySelectorAll('#experienceContainer > div').forEach(expDiv => {
                    const company = expDiv.querySelector('.exp-company').value;
                    const role = expDiv.querySelector('.exp-role').value;
                    const dates = expDiv.querySelector('.exp-dates').value;
                    const description = expDiv.querySelector('.exp-description').value.split('\n').filter(Boolean);
                    
                    if (company || role) {
                        updatedData.experience.push({ company, role, dates, description });
                    }
                });
                
                // Collect project data
                document.querySelectorAll('#projectsContainer > div').forEach(projDiv => {
                    const title = projDiv.querySelector('.proj-title').value;
                    const description = projDiv.querySelector('.proj-description').value;
                    const link = projDiv.querySelector('.proj-link').value;
                    
                    if (title) {
                        updatedData.projects.push({ title, description, link });
                    }
                });
                
                // Get selected theme
                const themeName = selectedTheme;
                const theme = themes[themeName] || themes['Default'];
                
                // If we have a portfolioId, update the existing portfolio
                if (portfolioId) {
                    console.log('Updating existing portfolio with ID:', portfolioId);
                    
                    const response = await fetch(`${API_URL}/api/update-portfolio/${portfolioId}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            portfolioData: updatedData,
                            theme,
                            profilePictureUrl
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        portfolioData = updatedData;
                        renderPortfolio(updatedData, theme, profilePictureUrl, portfolioId);
                        switchView('portfolioView');
                        
                        // Update portfolio links
                        const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
                        portfolioLink.textContent = portfolioUrl;
                        directLink.textContent = portfolioUrl;
                        
                        showToast('Portfolio updated successfully!', 'success');
                    } else {
                        throw new Error('Failed to update portfolio');
                    }
                } else {
                    console.log('Creating new portfolio');
                    
                    // Create new portfolio (manual creation)
                    // Prepare form data with photo if uploaded
                    const formData = new FormData();
                    formData.append('portfolioData', JSON.stringify(updatedData));
                    formData.append('theme', JSON.stringify(theme));
                    
                    // Add photo if uploaded in editor
                    const editorPhotoInput = document.getElementById('editorPhotoInput');
                    if (editorPhotoInput.files.length > 0) {
                        formData.append('photo', editorPhotoInput.files[0]);
                    }
                    
                    const response = await fetch(`${API_URL}/api/create-manual-portfolio`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    const result = await response.json();
                    
                    if (result.portfolioId) {
                        portfolioId = result.portfolioId;
                        portfolioData = updatedData;
                        profilePictureUrl = result.profilePictureUrl;
                        
                        // Add portfolio to student database
                        addPortfolioToDatabase(updatedData, themeName, portfolioId);
                        
                        renderPortfolio(updatedData, theme, profilePictureUrl, portfolioId);
                        switchView('portfolioView');
                        
                        // Update portfolio links
                        const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
                        portfolioLink.textContent = portfolioUrl;
                        directLink.textContent = portfolioUrl;
                        
                        showToast('Portfolio created successfully!', 'success');
                    } else {
                        throw new Error('Failed to create portfolio');
                    }
                }
            } catch (error) {
                console.error('Error in saveAndPreview:', error);
                showToast(`Error: ${error.message || 'Failed to save portfolio'}`, 'error');
            } finally {
                // Reset button state
                saveAndPreviewBtn.innerHTML = originalBtnText;
                saveAndPreviewBtn.disabled = false;
            }
        }
        
        // --- HELPER FUNCTIONS FOR URL/USERNAME CONVERSION ---
        function convertToUrl(platform, username) {
            if (!username) return '';
            
            // If it's already a URL, return as is
            if (username.startsWith('http://') || username.startsWith('https://')) {
                return username;
            }
            
            if (platform === 'linkedin') {
                return `https://linkedin.com/in/${username}`;
            } else if (platform === 'github') {
                return `https://github.com/${username}`;
            }
            
            return username;
        }
        
        function extractUsernameFromUrl(url, platform) {
            if (!url) return '';
            
            try {
                // If it's not a URL, return as is (might be just the username)
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    return url;
                }
                
                const urlObj = new URL(url);
                const pathname = urlObj.pathname;
                
                if (platform === 'linkedin') {
                    // LinkedIn URL: https://linkedin.com/in/username
                    const parts = pathname.split('/');
                    // Find the part after 'in'
                    const inIndex = parts.indexOf('in');
                    if (inIndex !== -1 && inIndex + 1 < parts.length) {
                        return parts[inIndex + 1];
                    }
                } else if (platform === 'github') {
                    // GitHub URL: https://github.com/username
                    const parts = pathname.split('/').filter(Boolean);
                    if (parts.length >= 1) {
                        return parts[0];
                    }
                }
            } catch (e) {
                console.error('Error parsing URL:', e);
            }
            
            return url;
        }
        
        // --- META TAGS UPDATE FUNCTION ---
        function updateMetaTags(data, portfolioUrl, profilePicUrl) {
            // If profilePicUrl is a data URL, we need to convert it to a publicly accessible URL
            let imageUrl = profilePicUrl;
            
            // Check if the image is a data URL (base64 encoded)
            if (profilePicUrl && profilePicUrl.startsWith('data:')) {
                // For data URLs, we need to create a public endpoint to serve the image
                // In a real implementation, you would upload this to a CDN or image hosting service
                // For now, we'll use a placeholder image
                imageUrl = `https://via.placeholder.com/1200x627/4F46E5/FFFFFF?text=${encodeURIComponent(data.personalInfo.name || 'Portfolio')}`;
                
                // If you have a public server, you can create an endpoint to serve the image
                // For example: imageUrl = `${PUBLIC_URL || SHAREABLE_URL}/api/portfolio-image/${portfolioId}`;
            }
            
            // Update document title
            document.title = `${data.personalInfo.name || 'Portfolio'} | Professional Portfolio`;
            // Update Open Graph meta tags
            const ogTitle = document.querySelector('meta[property="og:title"]');
            if (ogTitle) ogTitle.setAttribute('content', document.title);
            
            const ogDescription = document.querySelector('meta[property="og:description"]');
            if (ogDescription) {
                const description = data.summary || 
                    `${data.personalInfo.name || 'A professional'} with expertise in ${Array.isArray(data.skills) ? data.skills.map(s => typeof s === 'string' ? s : s.name).join(', ') : 'various fields'}.`;
                ogDescription.setAttribute('content', description);
            }
            
            const ogImage = document.querySelector('meta[property="og:image"]');
            if (ogImage) ogImage.setAttribute('content', imageUrl);
            
            const ogUrl = document.querySelector('meta[property="og:url"]');
            if (ogUrl) ogUrl.setAttribute('content', portfolioUrl);
            // Update Twitter Card meta tags
            const twitterTitle = document.querySelector('meta[name="twitter:title"]');
            if (twitterTitle) twitterTitle.setAttribute('content', document.title);
            
            const twitterDescription = document.querySelector('meta[name="twitter:description"]');
            if (twitterDescription) {
                const description = data.summary || 
                    `${data.personalInfo.name || 'A professional'} with expertise in ${Array.isArray(data.skills) ? data.skills.map(s => typeof s === 'string' ? s : s.name).join(', ') : 'various fields'}.`;
                twitterDescription.setAttribute('content', description);
            }
            
            const twitterImage = document.querySelector('meta[name="twitter:image"]');
            if (twitterImage) twitterImage.setAttribute('content', imageUrl);
            // Update canonical URL
            let canonicalLink = document.querySelector('link[rel="canonical"]');
            if (!canonicalLink) {
                canonicalLink = document.createElement('link');
                canonicalLink.rel = 'canonical';
                document.head.appendChild(canonicalLink);
            }
            canonicalLink.setAttribute('href', portfolioUrl);
            
            // Log the meta tags for debugging
            console.log('Meta tags updated:', {
                title: document.title,
                description: ogDescription ? ogDescription.getAttribute('content') : 'N/A',
                imageUrl: ogImage ? ogImage.getAttribute('content') : 'N/A',
                url: ogUrl ? ogUrl.getAttribute('content') : 'N/A'
            });
        }
        
        // --- RENDERING ---
        function renderPortfolio(data, theme, picUrl, portfolioId) {
            // Always use the new theme for portfolio generation
            const { personalInfo, summary, skills, experience, projects, education } = data;
            
            // Generate the portfolio HTML with the new theme
            const portfolioHtml = generateNewThemePortfolioHTML(data, picUrl);
            
            // Set the portfolio display content
            portfolioDisplay.innerHTML = portfolioHtml;
            
            // Update meta tags for social sharing
            const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
            updateMetaTags(data, portfolioUrl, picUrl);
        }
        
        function generateNewThemePortfolioHTML(data, picUrl) {
            const { personalInfo, summary, skills, experience, projects } = data;
            
            // Generate skills HTML
            const skillsHtml = Array.isArray(skills) && skills.length > 0
                ? skills.map(skill => `<span class="skill-badge">${typeof skill === 'string' ? skill : skill.name}</span>`).join('')
                : '<p class="text-gray-400">No skills listed.</p>';
                    
            // Generate experience HTML
            const experienceHtml = Array.isArray(experience) && experience.length > 0
                ? experience.map(job => `
                    <div class="experience-item mb-6">
                        <div class="flex flex-col md:flex-row md:justify-between md:items-start mb-2">
                            <h3 class="text-xl font-bold">${job.role || 'Role'}</h3>
                            <span class="text-gray-500">${job.dates || ''}</span>
                        </div>
                        <p class="text-gray-600 mb-3">${job.company || 'Company'}</p>
                        <ul class="list-disc list-inside space-y-1 text-gray-600">
                            ${(job.description || []).map(d => `<li>${d}</li>`).join('')}
                        </ul>
                    </div>
                `).join('')
                : '<p class="text-gray-400">No work experience listed.</p>';
            
            // Generate projects HTML
            const projectsHtml = Array.isArray(projects) && projects.length > 0
                ? projects.map(proj => `
                    <div class="project-card mb-4">
                        <div class="project-image">
                            ${proj.title || 'Project'}
                        </div>
                        <div class="project-details">
                            <h3 class="text-lg font-semibold mb-2">${proj.title || 'Project Title'}</h3>
                            <p class="text-gray-600">${proj.description || 'Project description'}</p>
                            ${proj.link ? `<a href="${proj.link}" target="_blank" class="text-blue-500 hover:text-blue-700 mt-2 inline-block">View Project</a>` : ''}
                        </div>
                    </div>
                `).join('')
                : '<p class="text-gray-400">No projects listed.</p>';
            
            // Generate social links HTML
            const socialLinksHtml = `
                ${personalInfo.email ? `
                    <a href="mailto:${personalInfo.email}" class="social-link">
                        <i class="fas fa-envelope"></i>
                    </a>` : ''}
                ${personalInfo.linkedin ? `
                    <a href="${personalInfo.linkedin}" target="_blank" class="social-link">
                        <i class="fab fa-linkedin"></i>
                    </a>` : ''}
                ${personalInfo.github ? `
                    <a href="${personalInfo.github}" target="_blank" class="social-link">
                        <i class="fab fa-github"></i>
                    </a>` : ''}
                ${personalInfo.website ? `
                    <a href="${personalInfo.website}" target="_blank" class="social-link">
                        <i class="fas fa-globe"></i>
                    </a>` : ''}
            `;
            
            // Return the complete portfolio HTML with the new theme
            return `
                <div class="new-portfolio-theme">
                    <header>
                        <div class="container">
                            <nav>
                                <div class="logo">AI Portfolio</div>
                                <ul class="nav-links">
                                    <li><a href="#home">Home</a></li>
                                    <li><a href="#about">About</a></li>
                                    <li><a href="#skills">Skills</a></li>
                                    <li><a href="#projects">Projects</a></li>
                                    <li><a href="#contact">Contact</a></li>
                                </ul>
                            </nav>
                        </div>
                    </header>

                    <!-- Hero Section -->
                    <section id="home" class="hero">
                        <div class="container">
                            <div class="hero-content">
                                <div class="hero-image">
                                    ${picUrl ? `<img src="${picUrl}" alt="${personalInfo.name || 'Profile'}">` : '<div class="profile-placeholder">Profile Image</div>'}
                                </div>
                                <div class="hero-text">
                                    <h1>${personalInfo.name || 'Your Name'}</h1>
                                    <p>${summary || 'Professional summary goes here'}</p>
                                    <a href="#contact" class="btn">Contact Me</a>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- About Section -->
                    <section id="about" class="about">
                        <div class="container">
                            <div class="section-title">
                                <h2>About Me</h2>
                                <p>${personalInfo.role || 'Professional Role'}</p>
                            </div>
                            <div class="about-content">
                                <div class="about-text">
                                    <p>${summary || 'Detailed about me section goes here. You can include your background, expertise, and career goals.'}</p>
                                </div>
                                <div class="about-image">
                                    ${picUrl ? `<img src="${picUrl}" alt="${personalInfo.name || 'Profile'}">` : '<div class="profile-placeholder">Profile Image</div>'}
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Experience Section -->
                    <section id="experience" class="experience">
                        <div class="container">
                            <div class="section-title">
                                <h2>Experience</h2>
                                <p>My professional journey</p>
                            </div>
                            <div class="experience-container">
                                ${experienceHtml}
                            </div>
                        </div>
                    </section>

                    <!-- Skills Section -->
                    <section id="skills" class="skills">
                        <div class="container">
                            <div class="section-title">
                                <h2>My Skills</h2>
                                <p>Technologies and tools I specialize in</p>
                            </div>
                            <div class="skills-container">
                                ${skillsHtml}
                            </div>
                        </div>
                    </section>

                    <!-- Projects Section -->
                    <section id="projects" class="projects">
                        <div class="container">
                            <div class="section-title">
                                <h2>My Projects</h2>
                                <p>Check out some of my recent work</p>
                            </div>
                            <div class="projects-container">
                                ${projectsHtml}
                            </div>
                        </div>
                    </section>

                    <!-- Contact Section -->
                    <section id="contact" class="contact">
                        <div class="container">
                            <div class="section-title">
                                <h2>Contact Me</h2>
                                <p>Get in touch for collaborations or inquiries</p>
                            </div>
                            <div class="contact-content">
                                <div class="contact-info">
                                    <div class="info-item">
                                        <div class="info-icon">@</div>
                                        <div>
                                            <h3>Email</h3>
                                            <p>${personalInfo.email || 'your.email@example.com'}</p>
                                        </div>
                                    </div>
                                    ${personalInfo.phone ? `
                                        <div class="info-item">
                                            <div class="info-icon">📱</div>
                                            <div>
                                                <h3>Phone</h3>
                                                <p>${personalInfo.phone}</p>
                                            </div>
                                        </div>
                                    ` : ''}
                                    <div class="info-item">
                                        <div class="info-icon">📍</div>
                                        <div>
                                            <h3>Location</h3>
                                            <p>${personalInfo.location || 'Your Location'}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="contact-form">
                                    <form id="portfolioContactForm">
                                        <div class="form-group">
                                            <label for="contactName">Name</label>
                                            <input type="text" id="contactName" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="contactEmail">Email</label>
                                            <input type="email" id="contactEmail" required>
                                        </div>
                                        <div class="form-group">
                                            <label for="contactMessage">Message</label>
                                            <textarea id="contactMessage" rows="4" required></textarea>
                                        </div>
                                        <button type="submit" class="btn">Send Message</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </section>

                    <footer>
                        <div class="container">
                            <div class="footer-content">
                                <h3>AI Portfolio Generator</h3>
                                <p>Creating innovative AI solutions for the future</p>
                                <div class="social-links">
                                    ${socialLinksHtml}
                                </div>
                            </div>
                            <div class="copyright">
                                <p>&copy; ${new Date().getFullYear()} AI Portfolio Generator. All rights reserved.</p>
                            </div>
                        </div>
                    </footer>
                </div>
            `;
        }
        
        // --- SHARING & LINK MANAGEMENT ---
        function testSharing() {
            if (!portfolioId || !PUBLIC_URL && !SHAREABLE_URL) {
                console.error('Cannot test sharing: missing portfolioId or URLs');
                showToast('Portfolio not ready for sharing', 'error');
                return;
            }
            
            const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
            
            console.log('Testing sharing functionality');
            console.log('Portfolio URL:', portfolioUrl);
            console.log('Meta tags:');
            console.log('  - Title:', document.querySelector('meta[property="og:title"]').getAttribute('content'));
            console.log('  - Description:', document.querySelector('meta[property="og:description"]').getAttribute('content'));
            console.log('  - Image:', document.querySelector('meta[property="og:image"]').getAttribute('content'));
            console.log('  - URL:', document.querySelector('meta[property="og:url"]').getAttribute('content'));
            
            showToast('Check console for sharing details', 'info');
        }
        
        function generateQRCode(url) {
            // If no URL is provided, use the current portfolio link
            if (!url) {
                url = directLink.textContent;
            }
            
            console.log(`Generating QR code with URL: ${url}`);
            if (url) {
                const qrcodeContainer = document.getElementById('qrcode');
                qrcodeContainer.innerHTML = ''; // Clear previous QR code
                
                // Check if QRCode library is available
                if (typeof QRCode === 'undefined') {
                    console.error('QRCode library not loaded');
                    qrcodeContainer.innerHTML = '<p class="text-red-500">QR Code library not available</p>';
                    return;
                }
                
                console.log(`Full URL for QR code: ${url}`);
                
                new QRCode(qrcodeContainer, {
                    text: url,
                    width: 128,
                    height: 128,
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
            } else {
                console.error('Cannot generate QR code: missing URL');
                showToast('Cannot generate QR code: missing portfolio information', 'error');
            }
        }
        
        function setupSocialSharing(shareUrl) {
            // If no URL is provided, use the current portfolio link
            if (!shareUrl) {
                shareUrl = directLink.textContent;
            }
            
            if (!shareUrl) {
                console.error('Cannot setup social sharing: missing URL');
                return;
            }
            
            const portfolioTitle = `${portfolioData.personalInfo.name || 'My'} Portfolio`;
            const portfolioDescription = portfolioData.summary || 'Check out my professional portfolio';
            
            console.log(`Setting up social sharing with URL: ${shareUrl}`);
            
            // Twitter
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(portfolioTitle)}&url=${encodeURIComponent(shareUrl)}`;
            document.getElementById('share-twitter').href = twitterUrl;
            console.log(`Twitter share URL: ${twitterUrl}`);
            
            // Facebook
            const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
            document.getElementById('share-facebook').href = facebookUrl;
            console.log(`Facebook share URL: ${facebookUrl}`);
            
            // LinkedIn
            const linkedinUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}`;
            document.getElementById('share-linkedin').href = linkedinUrl;
            console.log(`LinkedIn share URL: ${linkedinUrl}`);
        }
        
        async function sharePortfolio() {
            if (!portfolioData || Object.keys(portfolioData).length === 0) {
                showToast('Please create a portfolio first', 'error');
                return;
            }
            
            try {
                // For demo purposes, we'll just use the existing portfolio URL
                const portfolioUrl = `${PUBLIC_URL || SHAREABLE_URL}/portfolio/${portfolioId}`;
                
                // Update UI with shareable link
                portfolioLink.textContent = portfolioUrl;
                directLink.textContent = portfolioUrl;
                
                // Generate QR code
                generateQRCode(portfolioUrl);
                
                // Setup social sharing
                setupSocialSharing(portfolioUrl);
                
                // Show success message
                showToast('Portfolio is ready to share!', 'success');
                
                // Switch to portfolio view
                switchView('portfolioView');
            } catch (error) {
                console.error('Error sharing portfolio:', error);
                showToast('Failed to share portfolio. Please try again.', 'error');
            }
        }
        
        function copyLink() {
            // Get the current link from the UI
            const link = directLink.textContent;
            console.log(`Copying link: ${link}`);
            
            // Use the modern Clipboard API
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(link)
                    .then(() => {
                        showToast('Link copied to clipboard!', 'success');
                        console.log('Link copied successfully');
                    })
                    .catch(err => {
                        console.error('Failed to copy link:', err);
                        // Fallback for older browsers
                        fallbackCopyTextToClipboard(link);
                    });
            } else {
                // Fallback for older browsers
                fallbackCopyTextToClipboard(link);
            }
        }
        
        // Fallback for copying text to clipboard
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // Avoid scrolling to bottom
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showToast('Link copied to clipboard!', 'success');
                } else {
                    showToast('Failed to copy link', 'error');
                }
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
                showToast('Failed to copy link', 'error');
            }
            
            document.body.removeChild(textArea);
        }
        
        // --- TOAST NOTIFICATION ---
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            
            // Set icon based on type
            if (type === 'success') {
                toastIcon.className = 'fas fa-check-circle text-green-500 mr-3';
            } else if (type === 'error') {
                toastIcon.className = 'fas fa-exclamation-circle text-red-500 mr-3';
            } else if (type === 'info') {
                toastIcon.className = 'fas fa-info-circle text-blue-500 mr-3';
            }
            
            // Show toast
            toast.classList.remove('translate-y-20');
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.add('translate-y-20');
            }, 3000);
        }
        
        // --- ASSESSMENT SYSTEM FUNCTIONS ---
        function startAssessment(assessmentId) {
            currentAssessment = assessments[assessmentId];
            currentQuestionIndex = 0;
            selectedOption = null;
            userAnswers = [];
            timeRemaining = currentAssessment.timeLimit * 60; // Convert to seconds
            
            // Update UI
            document.getElementById('assessmentTitle').textContent = currentAssessment.title;
            document.getElementById('assessmentDescription').textContent = currentAssessment.description;
            document.getElementById('totalQuestions').textContent = currentAssessment.questions.length;
            
            // Load first question
            loadQuestion();
            
            // Start timer if time limit is set
            if (currentAssessment.timeLimit > 0) {
                startTimer();
            }
            
            // Switch to assessment view
            switchView('assessmentTakingView');
        }
        
        function loadQuestion() {
            const question = currentAssessment.questions[currentQuestionIndex];
            
            // Update question info
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('questionText').textContent = question.text;
            document.getElementById('difficultyBadge').textContent = question.difficulty.charAt(0).toUpperCase() + question.difficulty.slice(1);
            
            // Update progress bar
            const progress = ((currentQuestionIndex + 1) / currentAssessment.questions.length) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            // Load options
            const optionsContainer = document.querySelector('#questionContainer .space-y-4');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'p-4 bg-slate-800/50 rounded-lg cursor-pointer hover:bg-slate-700/50 transition-colors';
                optionElement.onclick = () => selectOption(index);
                
                optionElement.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full border-2 border-slate-500 mr-4 flex items-center justify-center option-radio">
                            <div class="w-3 h-3 rounded-full bg-indigo-500 hidden"></div>
                        </div>
                        <span>${option}</span>
                    </div>
                `;
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Reset feedback
            document.getElementById('feedbackContainer').classList.add('hidden');
            document.getElementById('questionContainer').classList.remove('hidden');
            document.getElementById('submitAnswerBtn').classList.remove('hidden');
            
            // Reset selected option
            selectedOption = null;
        }
        
        function selectOption(index) {
            // Update UI
            const optionRadios = document.querySelectorAll('.option-radio');
            optionRadios.forEach((radio, i) => {
                const dot = radio.querySelector('div');
                if (i === index) {
                    dot.classList.remove('hidden');
                    radio.parentElement.parentElement.classList.add('bg-slate-700/50');
                } else {
                    dot.classList.add('hidden');
                    radio.parentElement.parentElement.classList.remove('bg-slate-700/50');
                }
            });
            
            selectedOption = index;
        }
        
        function submitAnswer() {
            if (selectedOption === null) {
                showToast('Please select an answer', 'error');
                return;
            }
            
            const question = currentAssessment.questions[currentQuestionIndex];
            const isCorrect = selectedOption === question.correctAnswer;
            
            // Store answer
            userAnswers.push({
                questionIndex: currentQuestionIndex,
                selectedOption: selectedOption,
                isCorrect: isCorrect,
                timeTaken: currentAssessment.timeLimit * 60 - timeRemaining
            });
            
            // Show feedback
            showFeedback(isCorrect, question.explanation);
        }
        
        function showFeedback(isCorrect, explanation) {
            const feedbackContainer = document.getElementById('feedbackContainer');
            const feedbackContent = document.getElementById('feedbackContent');
            
            feedbackContainer.classList.remove('hidden');
            document.getElementById('questionContainer').classList.add('hidden');
            document.getElementById('submitAnswerBtn').classList.add('hidden');
            
            if (isCorrect) {
                feedbackContent.innerHTML = `
                    <div class="feedback-correct p-4 rounded-lg mb-4">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-white text-2xl mr-3"></i>
                            <span class="text-white font-bold">Correct!</span>
                        </div>
                    </div>
                    <p class="text-gray-300">${explanation}</p>
                `;
            } else {
                feedbackContent.innerHTML = `
                    <div class="feedback-incorrect p-4 rounded-lg mb-4">
                        <div class="flex items-center">
                            <i class="fas fa-times-circle text-white text-2xl mr-3"></i>
                            <span class="text-white font-bold">Incorrect</span>
                        </div>
                    </div>
                    <p class="text-gray-300">${explanation}</p>
                `;
            }
            
            // Auto-advance to next question after 3 seconds
            setTimeout(() => {
                nextQuestion();
            }, 3000);
        }
        
        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentAssessment.questions.length) {
                loadQuestion();
            } else {
                // Assessment completed
                completeAssessment();
            }
        }
        
        function completeAssessment() {
            // Stop timer if it's running
            if (assessmentTimer) {
                clearInterval(assessmentTimer);
            }
            
            // Check for unanswered questions and mark them as incorrect
            const totalQuestions = currentAssessment.questions.length;
            for (let i = 0; i < totalQuestions; i++) {
                if (!userAnswers.find(answer => answer.questionIndex === i)) {
                    userAnswers.push({
                        questionIndex: i,
                        selectedOption: null,
                        isCorrect: false,
                        timeTaken: 0
                    });
                }
            }
            
            // Calculate results
            const correctAnswers = userAnswers.filter(answer => answer.isCorrect).length;
            const scorePercentage = Math.round((correctAnswers / totalQuestions) * 100);
            const timeTaken = currentAssessment.timeLimit * 60 - timeRemaining;
            const minutes = Math.floor(timeTaken / 60);
            const seconds = timeTaken % 60;
            
            // Update results UI
            document.getElementById('scorePercentage').textContent = `${scorePercentage}%`;
            document.getElementById('correctAnswers').textContent = `${correctAnswers}/${totalQuestions}`;
            document.getElementById('timeTaken').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // Store results in student database
            storeAssessmentResults({
                assessmentId: currentAssessment.title,
                score: scorePercentage,
                correctAnswers: correctAnswers,
                totalQuestions: totalQuestions,
                timeTaken: timeTaken,
                date: new Date(),
                answers: userAnswers
            });
            
            // Switch to results view
            switchView('assessmentResultsView');
            
            // Show completion message
            showToast('Assessment completed successfully!', 'success');
        }
        
        function startTimer() {
            assessmentTimer = setInterval(() => {
                timeRemaining--;
                
                if (timeRemaining <= 0) {
                    // Time's up
                    clearInterval(assessmentTimer);
                    completeAssessment();
                    return;
                }
                
                // Update timer display
                const minutes = Math.floor(timeRemaining / 60);
                const seconds = timeRemaining % 60;
                document.getElementById('timer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Update progress bar
                const progress = ((currentAssessment.questions.length - (timeRemaining / (currentAssessment.timeLimit * 60)) * currentAssessment.questions.length) / currentAssessment.questions.length) * 100;
                document.getElementById('progressBar').style.width = `${progress}%`;
            }, 1000);
        }
        
        function exitAssessment() {
            if (confirm('Are you sure you want to exit this assessment? Your progress will be lost.')) {
                if (assessmentTimer) {
                    clearInterval(assessmentTimer);
                }
                switchView('assessmentsView');
            }
        }
        
        // --- ASSESSMENT REVIEW FUNCTIONS ---
        function reviewAnswers() {
            // Populate the assessment review view
            populateAssessmentReview();
            
            // Switch to review view
            switchView('assessmentReviewView');
        }
        
        function populateAssessmentReview() {
            assessmentReviewContainer.innerHTML = '';
            
            currentAssessment.questions.forEach((question, index) => {
                const userAnswer = userAnswers.find(a => a.questionIndex === index);
                const isCorrect = userAnswer ? userAnswer.isCorrect : false;
                const selectedOption = userAnswer ? userAnswer.selectedOption : -1;
                
                const reviewItem = document.createElement('div');
                reviewItem.className = 'assessment-review-item';
                
                let optionsHtml = '';
                question.options.forEach((option, optionIndex) => {
                    let optionClass = 'review-option';
                    
                    if (optionIndex === question.correctAnswer) {
                        optionClass += ' correct';
                    } else if (optionIndex === selectedOption) {
                        optionClass += ' incorrect';
                    } else if (optionIndex === selectedOption) {
                        optionClass += ' selected';
                    }
                    
                    optionsHtml += `
                        <div class="${optionClass}">
                            <div class="flex items-center">
                                <div class="w-6 h-6 rounded-full border-2 border-slate-500 mr-4 flex items-center justify-center">
                                    ${optionIndex === selectedOption ? '<div class="w-3 h-3 rounded-full bg-indigo-500"></div>' : ''}
                                </div>
                                <span>${option}</span>
                                ${optionIndex === question.correctAnswer ? '<i class="fas fa-check-circle text-green-500 ml-2"></i>' : ''}
                                ${optionIndex === selectedOption && optionIndex !== question.correctAnswer ? '<i class="fas fa-times-circle text-red-500 ml-2"></i>' : ''}
                            </div>
                        </div>
                    `;
                });
                
                reviewItem.innerHTML = `
                    <div class="review-question">
                        <span class="text-gray-400 text-sm">Question ${index + 1}</span>
                        <h4 class="text-lg font-bold mt-1">${question.text}</h4>
                    </div>
                    
                    <div class="review-options">
                        ${optionsHtml}
                    </div>
                    
                    <div class="review-explanation">
                        <div class="review-explanation-title">Explanation</div>
                        <p>${question.explanation}</p>
                    </div>
                `;
                
                assessmentReviewContainer.appendChild(reviewItem);
            });
        }
        
        // --- STUDENT DATABASE FUNCTIONS ---
        function initializeStudentDatabase() {
            // Try to load from localStorage
            const savedDb = localStorage.getItem('portfolioforge_student_db');
            
            if (savedDb) {
                studentDatabase = JSON.parse(savedDb);
                // Ensure all required arrays exist
                if (!studentDatabase.students) studentDatabase.students = [];
                if (!studentDatabase.assessments) studentDatabase.assessments = [];
                if (!studentDatabase.results) studentDatabase.results = [];
                if (!studentDatabase.portfolios) studentDatabase.portfolios = [];
            } else {
                // Initialize with some demo data
                studentDatabase = {
                    students: [
                        {
                            id: 'demo_user',
                            name: 'Demo User',
                            email: 'demo@example.com',
                            role: 'Developer',
                            skills: ['JavaScript', 'React', 'Node.js'],
                            joinDate: new Date(),
                            progress: {
                                completedAssessments: 5,
                                totalScore: 425,
                                averageScore: 85,
                                skills: {},
                                learningStreak: 7,
                                lastActivityDate: new Date()
                            }
                        }
                    ],
                    assessments: [
                        {
                            id: 'web-dev',
                            title: 'Web Development Fundamentals',
                            description: 'Test your knowledge of HTML, CSS, and JavaScript',
                            category: 'Web Development'
                        },
                        {
                            id: 'react',
                            title: 'React Framework',
                            description: 'Assess your understanding of React components, hooks, and state management',
                            category: 'Frontend'
                        }
                    ],
                    results: [
                        {
                            id: 'result1',
                            studentId: 'demo_user',
                            assessmentId: 'web-dev',
                            score: 90,
                            date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),
                            answers: []
                        },
                        {
                            id: 'result2',
                            studentId: 'demo_user',
                            assessmentId: 'react',
                            score: 85,
                            date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
                            answers: []
                        }
                    ],
                    portfolios: [
                        {
                            id: 'demo_portfolio_1',
                            title: 'Web Developer Portfolio',
                            owner: 'Demo User',
                            role: 'Frontend Developer',
                            description: 'A portfolio showcasing web development projects and skills',
                            content: '<div class="portfolio-demo-content"><h2>John Doe</h2><p>Frontend Developer</p></div>',
                            ratings: {
                                overall: 4.5,
                                visualDesign: 4,
                                contentQuality: 4,
                                navigationStructure: 5
                            },
                            reviews: []
                        },
                        {
                            id: 'demo_portfolio_2',
                            title: 'UX Designer Portfolio',
                            owner: 'Jane Smith',
                            role: 'UX Designer',
                            description: 'A portfolio showcasing UX design projects and case studies',
                            content: '<div class="portfolio-demo-content"><h2>Jane Smith</h2><p>UX Designer</p></div>',
                            ratings: {
                                overall: 4.2,
                                visualDesign: 5,
                                contentQuality: 4,
                                navigationStructure: 4
                            },
                            reviews: []
                        },
                        {
                            id: 'demo_portfolio_3',
                            title: 'Data Scientist Portfolio',
                            owner: 'Alex Johnson',
                            role: 'Data Scientist',
                            description: 'A portfolio showcasing data science projects and analyses',
                            content: '<div class="portfolio-demo-content"><h2>Alex Johnson</h2><p>Data Scientist</p></div>',
                            ratings: {
                                overall: 4.0,
                                visualDesign: 3,
                                contentQuality: 5,
                                navigationStructure: 4
                            },
                            reviews: []
                        }
                    ]
                };
                
                // Save to localStorage
                localStorage.setItem('portfolioforge_student_db', JSON.stringify(studentDatabase));
            }
        }
        
        function storeAssessmentResults(results) {
            if (!currentUser) {
                showToast('You must be logged in to save assessment results', 'error');
                return;
            }
            
            // Create a new result object
            const newResult = {
                id: 'result_' + Date.now(),
                studentId: currentUser.id,
                assessmentId: currentAssessment.title,
                score: results.score,
                correctAnswers: results.correctAnswers,
                totalQuestions: results.totalQuestions,
                timeTaken: results.timeTaken,
                date: new Date().toISOString(),
                answers: results.answers
            };
            
            // Add to database
            studentDatabase.results.push(newResult);
            
            // Update user progress
            if (!currentUser.progress) {
                currentUser.progress = {
                    completedAssessments: 0,
                    totalScore: 0,
                    averageScore: 0,
                    skills: {},
                    learningStreak: 0,
                    lastActivityDate: new Date()
                };
            }
            
            currentUser.progress.completedAssessments++;
            currentUser.progress.totalScore += results.score;
            currentUser.progress.averageScore = Math.round(currentUser.progress.totalScore / currentUser.progress.completedAssessments);
            currentUser.progress.lastActivityDate = new Date();
            
            // Update learning streak
            const lastActivity = new Date(currentUser.progress.lastActivityDate);
            const today = new Date();
            const diffTime = Math.abs(today - lastActivity);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 1) {
                currentUser.progress.learningStreak++;
            } else if (diffDays > 1) {
                currentUser.progress.learningStreak = 1;
            }
            
            // Update skills based on assessment category
            if (currentAssessment.title.includes('Web Development')) {
                currentUser.progress.skills['Web Development'] = Math.max(
                    currentUser.progress.skills['Web Development'] || 0,
                    results.score
                );
            } else if (currentAssessment.title.includes('React')) {
                currentUser.progress.skills['React'] = Math.max(
                    currentUser.progress.skills['React'] || 0,
                    results.score
                );
            }
            
            // Save to localStorage
            localStorage.setItem('portfolioforge_student_db', JSON.stringify(studentDatabase));
            
            // Update UI
            updateDashboard();
        }
        
        function addPortfolioToDatabase(portfolioData, themeName, portfolioId) {
            if (!currentUser) return;
            
            // Ensure portfolios array exists
            if (!studentDatabase.portfolios) {
                studentDatabase.portfolios = [];
            }
            
            // Create a new portfolio object
            const newPortfolio = {
                id: portfolioId,
                title: `${portfolioData.personalInfo.name || 'My'} Portfolio`,
                owner: currentUser.name,
                role: currentUser.role || 'Professional',
                description: portfolioData.summary || 'Professional portfolio',
                content: JSON.stringify(portfolioData),
                theme: themeName,
                ratings: {
                    overall: 0,
                    visualDesign: 0,
                    contentQuality: 0,
                    navigationStructure: 0
                },
                reviews: []
            };
            
            // Add to database
            studentDatabase.portfolios.push(newPortfolio);
            
            // Save to localStorage
            localStorage.setItem('portfolioforge_student_db', JSON.stringify(studentDatabase));
            
            console.log('Portfolio added to database:', newPortfolio);
        }
        
        // --- CHARTS INITIALIZATION ---
        function initializeCharts() {
            // Destroy existing charts if they exist
            if (performanceChart) {
                performanceChart.destroy();
            }
            if (skillChart) {
                skillChart.destroy();
            }
            
            // Performance Over Time Chart
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            performanceChart = new Chart(performanceCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Assessment Score',
                        data: [65, 70, 80, 81, 85, 87],
                        borderColor: 'rgb(99, 102, 241)',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });
            
            // Skill Distribution Chart
            const skillCtx = document.getElementById('skillChart').getContext('2d');
            skillChart = new Chart(skillCtx, {
                type: 'radar',
                data: {
                    labels: ['Web Development', 'React', 'Node.js', 'Data Analysis', 'UI/UX Design'],
                    datasets: [{
                        label: 'Skill Level',
                        data: [85, 90, 75, 70, 65],
                        backgroundColor: 'rgba(99, 102, 241, 0.2)',
                        borderColor: 'rgb(99, 102, 241)',
                        pointBackgroundColor: 'rgb(99, 102, 241)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(99, 102, 241)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            angleLines: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            pointLabels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            ticks: {
                                backdropColor: 'transparent',
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });
        }
        
        // --- PEER REVIEW FUNCTIONS ---
        function startPeerReview() {
            // Show the list of portfolios to review
            showPeerReviewList();
        }
        
        function showPeerReviewList() {
            switchView('peerReviewListView');
            populatePeerReviewList();
        }
        
        function populatePeerReviewList() {
            peerReviewListContainer.innerHTML = '';

            // Use portfolios from the database
            const portfolios = studentDatabase.portfolios || [];

            portfolios.forEach(portfolio => {
                const card = document.createElement('div');
                card.className = 'portfolio-card glass p-6 rounded-xl';
                card.onclick = () => selectPortfolioForReview(portfolio);

                card.innerHTML = `
                    <div class="portfolio-card-header">
                        <div class="w-12 h-12 rounded-full bg-indigo-900/50 flex items-center justify-center mr-4">
                            <i class="fas fa-user text-indigo-400 text-xl"></i>
                        </div>
                        <div class="portfolio-card-badge">
                            Portfolio
                        </div>
                    </div>
                    <h3 class="portfolio-card-title">${portfolio.title}</h3>
                    <p class="portfolio-card-meta">Owner: ${portfolio.owner}</p>
                    <p class="portfolio-card-meta">Role: ${portfolio.role}</p>
                    <p class="portfolio-card-description">${portfolio.description}</p>
                    <div class="portfolio-card-footer">
                        <div class="portfolio-card-stats">
                            <div class="portfolio-card-stat">
                                <i class="fas fa-eye text-gray-400"></i>
                                <span>124 views</span>
                            </div>
                            <div class="portfolio-card-stat">
                                <i class="fas fa-star text-yellow-400"></i>
                                <span>${portfolio.ratings.overall.toFixed(1)}</span>
                            </div>
                        </div>
                    </div>
                `;

                peerReviewListContainer.appendChild(card);
            });
        }
        
        function selectPortfolioForReview(portfolio) {
            currentPortfolioForReview = portfolio;
            // Start the peer review assessment
            startPeerReviewAssessment();
        }
        
        function startPeerReviewAssessment() {
            currentAssessment = assessments['peer-review'];
            currentQuestionIndex = 0;
            selectedOption = null;
            peerReviewUserAnswers = [];
            peerReviewTimeRemaining = currentAssessment.timeLimit * 60; // Will be 0

            // Reset ratings and comments
            peerReviewRatings = {
                overall: 0,
                visualDesign: 0,
                contentQuality: 0,
                navigationStructure: 0
            };
            peerReviewComments = {
                strengths: '',
                improvements: '',
                additional: ''
            };

            // Update UI
            document.getElementById('peerReviewTitle').textContent = `Peer Review: ${currentPortfolioForReview.title}`;
            document.getElementById('peerReviewDescription').innerHTML = `Reviewing the portfolio of <span id="portfolioOwnerName">${currentPortfolioForReview.owner}</span>`;
            document.getElementById('peerReviewTotalQuestions').textContent = currentAssessment.questions.length;

            // Load portfolio preview
            loadPortfolioPreview();

            // Load first question
            loadPeerReviewQuestion();

            // Start timer if time limit is set (for peer review, it's 0 so we skip)
            if (currentAssessment.timeLimit > 0) {
                startPeerReviewTimer();
                document.getElementById('peerReviewTimerContainer').style.display = 'block';
            } else {
                document.getElementById('peerReviewTimerContainer').style.display = 'none';
            }

            // Switch to peer review taking view
            switchView('peerReviewTakingView');
        }
        
        function loadPortfolioPreview() {
            portfolioPreview.innerHTML = currentPortfolioForReview.content;
        }
        
        function loadPeerReviewQuestion() {
            const question = currentAssessment.questions[currentQuestionIndex];
            
            // Update question info
            document.getElementById('peerReviewCurrentQuestion').textContent = currentQuestionIndex + 1;
            document.getElementById('peerReviewQuestionText').textContent = question.text;
            document.getElementById('peerReviewDifficultyBadge').textContent = question.difficulty.charAt(0).toUpperCase() + question.difficulty.slice(1);
            
            // Update progress bar
            const progress = ((currentQuestionIndex + 1) / currentAssessment.questions.length) * 100;
            document.getElementById('peerReviewProgressBar').style.width = `${progress}%`;
            
            // Load options
            const optionsContainer = document.getElementById('peerReviewOptionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'p-4 bg-slate-800/50 rounded-lg cursor-pointer hover:bg-slate-700/50 transition-colors';
                optionElement.onclick = () => peerReviewSelectOption(index);
                
                optionElement.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full border-2 border-slate-500 mr-4 flex items-center justify-center option-radio">
                            <div class="w-3 h-3 rounded-full bg-indigo-500 hidden"></div>
                        </div>
                        <span>${option}</span>
                    </div>
                `;
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Reset feedback
            document.getElementById('peerReviewFeedbackContainer').classList.add('hidden');
            document.getElementById('peerReviewQuestionContainer').classList.remove('hidden');
            document.getElementById('peerReviewSubmitAnswerBtn').classList.remove('hidden');
            
            // Reset selected option
            selectedOption = null;
        }
        
        function peerReviewSelectOption(index) {
            // Update UI
            const optionRadios = document.querySelectorAll('#peerReviewOptionsContainer .option-radio');
            optionRadios.forEach((radio, i) => {
                const dot = radio.querySelector('div');
                if (i === index) {
                    dot.classList.remove('hidden');
                    radio.parentElement.parentElement.classList.add('bg-slate-700/50');
                } else {
                    dot.classList.add('hidden');
                    radio.parentElement.parentElement.classList.remove('bg-slate-700/50');
                }
            });
            
            selectedOption = index;
        }
        
        function peerReviewSubmitAnswer() {
            if (selectedOption === null) {
                showToast('Please select an answer', 'error');
                return;
            }
            
            const question = currentAssessment.questions[currentQuestionIndex];
            // For peer review, there is no correct answer, so we just store the selected option
            
            // Store answer
            peerReviewUserAnswers.push({
                questionIndex: currentQuestionIndex,
                selectedOption: selectedOption,
                timeTaken: currentAssessment.timeLimit * 60 - peerReviewTimeRemaining
            });
            
            // Update ratings based on question category
            if (question.category === 'Visual Design') {
                peerReviewRatings.visualDesign = selectedOption + 1;
            } else if (question.category === 'Content Quality') {
                peerReviewRatings.contentQuality = selectedOption + 1;
            } else if (question.category === 'Navigation') {
                peerReviewRatings.navigationStructure = selectedOption + 1;
            }
            
            // Show feedback (for peer review, we just show a thank you message)
            showPeerReviewFeedback();
        }
        
        function showPeerReviewFeedback() {
            const feedbackContainer = document.getElementById('peerReviewFeedbackContainer');
            const feedbackContent = document.getElementById('peerReviewFeedbackContent');
            
            feedbackContainer.classList.remove('hidden');
            document.getElementById('peerReviewQuestionContainer').classList.add('hidden');
            document.getElementById('peerReviewSubmitAnswerBtn').classList.add('hidden');
            
            feedbackContent.innerHTML = `
                <div class="p-4 rounded-lg mb-4" style="background: linear-gradient(135deg, #10b981, #059669);">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-white text-2xl mr-3"></i>
                        <span class="text-white font-bold">Answer Recorded</span>
                    </div>
                </div>
                <p class="text-gray-300">Thank you for your feedback. Your response has been recorded.</p>
            `;
            
            // Auto-advance to next question after 2 seconds
            setTimeout(() => {
                peerReviewNextQuestion();
            }, 2000);
        }
        
        function peerReviewNextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentAssessment.questions.length) {
                loadPeerReviewQuestion();
            } else {
                // Peer review completed
                completePeerReview();
            }
        }
        
        function completePeerReview() {
            // Stop timer if it's running
            if (peerReviewTimer) {
                clearInterval(peerReviewTimer);
            }
            
            // Calculate overall rating (average of all ratings)
            const ratings = Object.values(peerReviewRatings).filter(rating => rating > 0);
            peerReviewRatings.overall = ratings.length > 0 
                ? Math.round(ratings.reduce((sum, rating) => sum + rating, 0) / ratings.length)
                : 0;
            
            // Store results (similar to storeAssessmentResults but for peer review)
            storePeerReviewResults({
                assessmentId: currentAssessment.title,
                portfolioId: currentPortfolioForReview.id,
                ratings: peerReviewRatings,
                answers: peerReviewUserAnswers,
                date: new Date()
            });
            
            // Show results
            showPeerReviewResults();
        }
        
        function storePeerReviewResults(results) {
            // In a real app, this would be sent to the backend
            console.log('Storing peer review results:', results);
            
            // Update the portfolio ratings in the database
            const portfolioIndex = studentDatabase.portfolios.findIndex(p => p.id === results.portfolioId);
            if (portfolioIndex !== -1) {
                // Update ratings (simple average)
                const portfolio = studentDatabase.portfolios[portfolioIndex];
                const reviewCount = portfolio.reviews.length + 1;
                
                // Calculate new average ratings
                const newOverallRating = ((portfolio.ratings.overall * portfolio.reviews.length) + results.ratings.overall) / reviewCount;
                const newVisualDesignRating = ((portfolio.ratings.visualDesign * portfolio.reviews.length) + results.ratings.visualDesign) / reviewCount;
                const newContentQualityRating = ((portfolio.ratings.contentQuality * portfolio.reviews.length) + results.ratings.contentQuality) / reviewCount;
                const newNavigationStructureRating = ((portfolio.ratings.navigationStructure * portfolio.reviews.length) + results.ratings.navigationStructure) / reviewCount;
                
                // Update portfolio ratings
                portfolio.ratings.overall = newOverallRating;
                portfolio.ratings.visualDesign = newVisualDesignRating;
                portfolio.ratings.contentQuality = newContentQualityRating;
                portfolio.ratings.navigationStructure = newNavigationStructureRating;
                
                // Add review to portfolio
                portfolio.reviews.push({
                    reviewerId: currentUser.id,
                    reviewerName: currentUser.name,
                    ratings: results.ratings,
                    date: new Date().toISOString()
                });
                
                // Save to localStorage
                localStorage.setItem('portfolioforge_student_db', JSON.stringify(studentDatabase));
                
                console.log('Portfolio ratings updated:', portfolio.ratings);
            }
            
            // For demo, we'll just show a message
            showToast('Peer review results saved!', 'success');
        }
        
        function showPeerReviewResults() {
            // Populate the peer review results view
            populatePeerReviewResults();
            
            // Switch to results view
            switchView('peerReviewResultsView');
        }
        
        function populatePeerReviewResults() {
            // Update overall rating display
            const overallRating = peerReviewRatings.overall;
            const starsHtml = generateStarRating(overallRating);
            
            document.getElementById('peerReviewResultsView').querySelector('.rating-stars').innerHTML = starsHtml;
            
            // Update category ratings
            const reviewCategories = document.querySelectorAll('#peerReviewResultsView .review-category');
            reviewCategories.forEach(category => {
                const categoryName = category.querySelector('h4').textContent.toLowerCase().replace(' ', '');
                const rating = peerReviewRatings[categoryName] || 0;
                category.querySelector('.rating-stars').innerHTML = generateStarRating(rating);
            });
        }
        
        function generateStarRating(rating) {
            let starsHtml = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            // Full stars
            for (let i = 0; i < fullStars; i++) {
                starsHtml += '<i class="fas fa-star"></i>';
            }
            
            // Half star
            if (hasHalfStar) {
                starsHtml += '<i class="fas fa-star-half-alt"></i>';
            }
            
            // Empty stars
            const emptyStars = 5 - Math.ceil(rating);
            for (let i = 0; i < emptyStars; i++) {
                starsHtml += '<i class="far fa-star"></i>';
            }
            
            return starsHtml;
        }
        
        function exitPeerReview() {
            if (confirm('Are you sure you want to exit this peer review? Your progress will be lost.')) {
                if (peerReviewTimer) {
                    clearInterval(peerReviewTimer);
                }
                switchView('assessmentsView');
            }
        }
        
        function startPeerReviewTimer() {
            peerReviewTimer = setInterval(() => {
                peerReviewTimeRemaining--;
                
                if (peerReviewTimeRemaining <= 0) {
                    // Time's up
                    clearInterval(peerReviewTimer);
                    completePeerReview();
                    return;
                }
                
                // Update timer display
                const minutes = Math.floor(peerReviewTimeRemaining / 60);
                const seconds = peerReviewTimeRemaining % 60;
                document.getElementById('peerReviewTimer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Update progress bar
                const progress = ((currentAssessment.questions.length - (peerReviewTimeRemaining / (currentAssessment.timeLimit * 60)) * currentAssessment.questions.length) / currentAssessment.questions.length) * 100;
                document.getElementById('peerReviewProgressBar').style.width = `${progress}%`;
            }, 1000);
        }
    </script>
</body>
</html>